<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Final Project</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/clipboard.min.js"></script>
<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/quarto.js" type="module"></script>
<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/tabsets.js" type="module"></script>
<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/popper.min.js"></script>
<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/tippy.umd.min.js"></script>
<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/anchor.min.js"></script>
<link href="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/tippy.css" rel="stylesheet">
<link href="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/bootstrap.min.js"></script>
<link href="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/bootstrap-icons.css" rel="stylesheet">
<link href="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


<style>.ansi-display{font-family:monospace;white-space:pre-wrap;--ansiBlack: #000000;--ansiRed: #cd3131;--ansiGreen: #00BC00;--ansiYellow: #949800;--ansiBlue: #0451a5;--ansiMagenta: #bc05bc;--ansiCyan: #0598bc;--ansiWhite: #555555;--ansiBrightBlack: #666666;--ansiBrightRed: #cd3131;--ansiBrightGreen: #14CE14;--ansiBrightYellow: #b5ba00;--ansiBrightBlue: #0451a5;--ansiBrightMagenta: #bc05bc;--ansiBrightCyan: #0598bc;--ansiBrightWhite: #a5a5a5}.dark-mode .ansi-display{--ansiBlack: #000000;--ansiRed: #cd3131;--ansiGreen: #0DBC79;--ansiYellow: #e5e510;--ansiBlue: #2472c8;--ansiMagenta: #bc3fbc;--ansiCyan: #11a8cd;--ansiWhite: #e5e5e5;--ansiBrightBlack: #666666;--ansiBrightRed: #f14c4c;--ansiBrightGreen: #23d18b;--ansiBrightYellow: #f5f543;--ansiBrightBlue: #3b8eea;--ansiBrightMagenta: #d670d6;--ansiBrightCyan: #29b8db;--ansiBrightWhite: #e5e5e5}@keyframes ansi-displaly-run-blink{50%{opacity:0}}.fui-FluentProvider h2{border-bottom:none;padding-bottom:0}</style><style data-make-styles-bucket="d" data-priority="0"></style><style id="fui-FluentProviderr0"></style></head>

<body class="fullcontent quarto-light" data-tabster="{&quot;root&quot;:{}}">

<i tabindex="0" role="none" data-tabster-dummy="" aria-hidden="true" style="position: fixed; height: 1px; width: 1px; opacity: 0.001; z-index: -1; content-visibility: hidden; top: 0px; left: 0px;"></i><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Project</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.2.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">duckdb.enable_rstudio_connection_pane=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>drv <span class="ot">&lt;-</span> <span class="fu">duckdb</span>()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(drv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="inf-385t.9---data-wrangling-final-project-does-positive-pop-music-portend-positive-attitudes" class="level2">
<h2 class="anchored" data-anchor-id="inf-385t.9---data-wrangling-final-project-does-positive-pop-music-portend-positive-attitudes">INF 385T.9 - Data Wrangling Final Project: Does Positive Pop Music Portend Positive Attitudes?<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#inf-385t.9---data-wrangling-final-project-does-positive-pop-music-portend-positive-attitudes" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="sql-duckdb" class="level2">
<h2 class="anchored" data-anchor-id="sql-duckdb">SQL (DuckDB)<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#sql-duckdb" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="import-dataset-1---world-happiness-report" class="level2">
<h2 class="anchored" data-anchor-id="import-dataset-1---world-happiness-report">Import Dataset 1 - World Happiness Report<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-dataset-1---world-happiness-report" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<p>References:</p>
<p><a href="https://duckdb.org/docs/stable/data/csv/overview" class="uri">https://duckdb.org/docs/stable/data/csv/overview</a></p>
</section>
<section id="load-world-happiness-report-2023" class="level2">
<h2 class="anchored" data-anchor-id="load-world-happiness-report-2023">Load World Happiness Report 2023<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#load-world-happiness-report-2023" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> whr <span class="kw">AS</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> read_csv(<span class="st">'whr.csv'</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> whr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Country name</th>
<th style="text-align: right;">Ladder score</th>
<th style="text-align: right;">Standard error of ladder score</th>
<th style="text-align: right;">upperwhisker</th>
<th style="text-align: right;">lowerwhisker</th>
<th style="text-align: right;">Logged GDP per capita</th>
<th style="text-align: right;">Social support</th>
<th style="text-align: right;">Healthy life expectancy</th>
<th style="text-align: right;">Freedom to make life choices</th>
<th style="text-align: right;">Generosity</th>
<th style="text-align: right;">Perceptions of corruption</th>
<th style="text-align: right;">Ladder score in Dystopia</th>
<th style="text-align: right;">Explained by: Log GDP per capita</th>
<th style="text-align: right;">Explained by: Social support</th>
<th style="text-align: right;">Explained by: Healthy life expectancy</th>
<th style="text-align: right;">Explained by: Freedom to make life choices</th>
<th style="text-align: right;">Explained by: Generosity</th>
<th style="text-align: right;">Explained by: Perceptions of corruption</th>
<th style="text-align: right;">Dystopia + residual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Finland</td>
<td style="text-align: right;">7.804</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">7.875</td>
<td style="text-align: right;">7.733</td>
<td style="text-align: right;">10.792</td>
<td style="text-align: right;">0.969</td>
<td style="text-align: right;">71.150</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: right;">-0.019</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.888</td>
<td style="text-align: right;">1.585</td>
<td style="text-align: right;">0.535</td>
<td style="text-align: right;">0.772</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">0.535</td>
<td style="text-align: right;">2.363</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">7.586</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">7.667</td>
<td style="text-align: right;">7.506</td>
<td style="text-align: right;">10.962</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">71.250</td>
<td style="text-align: right;">0.934</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.949</td>
<td style="text-align: right;">1.548</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">2.084</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iceland</td>
<td style="text-align: right;">7.530</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">7.625</td>
<td style="text-align: right;">7.434</td>
<td style="text-align: right;">10.896</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: right;">72.050</td>
<td style="text-align: right;">0.936</td>
<td style="text-align: right;">0.211</td>
<td style="text-align: right;">0.668</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.926</td>
<td style="text-align: right;">1.620</td>
<td style="text-align: right;">0.559</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">2.250</td>
</tr>
<tr class="even">
<td style="text-align: left;">Israel</td>
<td style="text-align: right;">7.473</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">7.535</td>
<td style="text-align: right;">7.411</td>
<td style="text-align: right;">10.639</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">72.697</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-0.023</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.833</td>
<td style="text-align: right;">1.521</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">2.691</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">7.403</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">7.460</td>
<td style="text-align: right;">7.346</td>
<td style="text-align: right;">10.942</td>
<td style="text-align: right;">0.930</td>
<td style="text-align: right;">71.550</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.213</td>
<td style="text-align: right;">0.379</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.942</td>
<td style="text-align: right;">1.488</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">0.672</td>
<td style="text-align: right;">0.251</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">2.110</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweden</td>
<td style="text-align: right;">7.395</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">7.468</td>
<td style="text-align: right;">7.322</td>
<td style="text-align: right;">10.883</td>
<td style="text-align: right;">0.939</td>
<td style="text-align: right;">72.150</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.921</td>
<td style="text-align: right;">1.510</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.754</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">1.903</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">7.315</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">7.402</td>
<td style="text-align: right;">7.229</td>
<td style="text-align: right;">11.088</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">71.500</td>
<td style="text-align: right;">0.947</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.994</td>
<td style="text-align: right;">1.521</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">1.829</td>
</tr>
<tr class="even">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">7.240</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">7.324</td>
<td style="text-align: right;">7.156</td>
<td style="text-align: right;">11.164</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">72.900</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.266</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">2.022</td>
<td style="text-align: right;">1.463</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.475</td>
<td style="text-align: right;">1.870</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: right;">7.228</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">7.363</td>
<td style="text-align: right;">7.093</td>
<td style="text-align: right;">11.660</td>
<td style="text-align: right;">0.879</td>
<td style="text-align: right;">71.675</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.345</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">2.200</td>
<td style="text-align: right;">1.357</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">1.845</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">7.123</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">7.198</td>
<td style="text-align: right;">7.048</td>
<td style="text-align: right;">10.662</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">70.350</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">1.778</td>
<td style="text-align: right;">1.842</td>
<td style="text-align: right;">1.544</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.672</td>
<td style="text-align: right;">0.230</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">1.852</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="remove-standard.error.of.ladder.score-upperwhisker-and-lowerwhisker-columns-rename-columns-for-more-intuitive-understanding" class="level2">
<h2 class="anchored" data-anchor-id="remove-standard.error.of.ladder.score-upperwhisker-and-lowerwhisker-columns-rename-columns-for-more-intuitive-understanding">Remove Standard.error.of.ladder.score, upperwhisker, and lowerwhisker columns – Rename columns for more intuitive understanding<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-standard.error.of.ladder.score-upperwhisker-and-lowerwhisker-columns-rename-columns-for-more-intuitive-understanding" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> happiness_report_23 <span class="kw">AS</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="ot">"Country name"</span> <span class="kw">AS</span> country_name,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="ot">"Ladder score"</span> <span class="kw">AS</span> happiness_score,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>          <span class="ot">"Logged GDP per capita"</span> <span class="kw">AS</span> gdp_wellbeing,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>          <span class="ot">"Social support"</span> <span class="kw">AS</span> social_support,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>          <span class="ot">"Healthy life expectancy"</span> <span class="kw">AS</span> life_exp,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>          <span class="ot">"Freedom to make life choices"</span> <span class="kw">AS</span> freedom,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>          <span class="ot">"Generosity"</span> <span class="kw">AS</span> generosity</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> whr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> happiness_report_23</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">country_name</th>
<th style="text-align: right;">happiness_score</th>
<th style="text-align: right;">gdp_wellbeing</th>
<th style="text-align: right;">social_support</th>
<th style="text-align: right;">life_exp</th>
<th style="text-align: right;">freedom</th>
<th style="text-align: right;">generosity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Finland</td>
<td style="text-align: right;">7.804</td>
<td style="text-align: right;">10.792</td>
<td style="text-align: right;">0.969</td>
<td style="text-align: right;">71.150</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: right;">-0.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">7.586</td>
<td style="text-align: right;">10.962</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">71.250</td>
<td style="text-align: right;">0.934</td>
<td style="text-align: right;">0.134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iceland</td>
<td style="text-align: right;">7.530</td>
<td style="text-align: right;">10.896</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: right;">72.050</td>
<td style="text-align: right;">0.936</td>
<td style="text-align: right;">0.211</td>
</tr>
<tr class="even">
<td style="text-align: left;">Israel</td>
<td style="text-align: right;">7.473</td>
<td style="text-align: right;">10.639</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">72.697</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-0.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">7.403</td>
<td style="text-align: right;">10.942</td>
<td style="text-align: right;">0.930</td>
<td style="text-align: right;">71.550</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.213</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweden</td>
<td style="text-align: right;">7.395</td>
<td style="text-align: right;">10.883</td>
<td style="text-align: right;">0.939</td>
<td style="text-align: right;">72.150</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">7.315</td>
<td style="text-align: right;">11.088</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">71.500</td>
<td style="text-align: right;">0.947</td>
<td style="text-align: right;">0.141</td>
</tr>
<tr class="even">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">7.240</td>
<td style="text-align: right;">11.164</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">72.900</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: right;">7.228</td>
<td style="text-align: right;">11.660</td>
<td style="text-align: right;">0.879</td>
<td style="text-align: right;">71.675</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">0.024</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">7.123</td>
<td style="text-align: right;">10.662</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">70.350</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.175</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="import-dataset-2---spotify-global-top-50-song-data-kaggle" class="level2">
<h2 class="anchored" data-anchor-id="import-dataset-2---spotify-global-top-50-song-data-kaggle">Import Dataset 2 - Spotify Global Top 50 Song Data (Kaggle)<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-dataset-2---spotify-global-top-50-song-data-kaggle" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<p><a href="https://duckdb.org/docs/stable/sql/functions/text" class="uri">https://duckdb.org/docs/stable/sql/functions/text</a></p>
<section id="load-global-top-spotify-song-dataset" class="level4">
<h4 class="anchored" data-anchor-id="load-global-top-spotify-song-dataset">Load global top spotify song dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#load-global-top-spotify-song-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="select-name-artists-country-danceability-energy-loudness-valence-and-tempo" class="level4">
<h4 class="anchored" data-anchor-id="select-name-artists-country-danceability-energy-loudness-valence-and-tempo">Select name, artists, country, danceability, energy, loudness, valence, and tempo<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#select-name-artists-country-danceability-energy-loudness-valence-and-tempo" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="rename-name-column-as-title" class="level4">
<h4 class="anchored" data-anchor-id="rename-name-column-as-title">Rename name column as title<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#rename-name-column-as-title" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> spotify_2023 <span class="kw">AS</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> name <span class="kw">AS</span> title,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         artists,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         country,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         danceability,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         energy,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>         loudness,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>         valence,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>         tempo</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> read_csv(<span class="st">'universal_top_spotify_songs.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> spotify_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 29%">
<col style="width: 27%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artists</th>
<th style="text-align: left;">country</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Từng Quen</td>
<td style="text-align: left;">Wren Evans, itsnk</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">0.246</td>
<td style="text-align: right;">-16.913</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">77.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Standing Next to You</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-4.389</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">106.017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Like Crazy</td>
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">-5.445</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">120.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seven (feat. Latto) (Explicit Ver.)</td>
<td style="text-align: left;">Jung Kook, Latto</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.831</td>
<td style="text-align: right;">-4.185</td>
<td style="text-align: right;">0.872</td>
<td style="text-align: right;">124.987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Slow Dancing</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">-7.758</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">155.960</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hit Me Up (feat. Nomovodka)</td>
<td style="text-align: left;">Binz, Nomovodka</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">-9.050</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">99.993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anh Là Ngoại Lệ Của Em</td>
<td style="text-align: left;">Phương Ly</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">-5.958</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">111.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bạn Đời</td>
<td style="text-align: left;">Karik, GDucky</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">-8.246</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">129.987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Đánh Đổi (ft. RPT MCK)</td>
<td style="text-align: left;">Obito, RPT MCK</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">-12.294</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">76.876</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lệ Lưu Ly</td>
<td style="text-align: left;">Vũ Phụng Tiên, DT Tập Rap, Drum7</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.771</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">-10.909</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">94.997</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="split-the-artists-column-and-only-keep-the-first-artist" class="level2">
<h2 class="anchored" data-anchor-id="split-the-artists-column-and-only-keep-the-first-artist">Split the artists column and only keep the first artist<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#split-the-artists-column-and-only-keep-the-first-artist" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> global_spotify_2023 <span class="kw">AS</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> title,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         STRING_SPLIT(artists, <span class="st">','</span>) [<span class="dv">1</span>] <span class="kw">AS</span> artist,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         country,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         danceability,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         energy,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         loudness,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         valence,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         tempo</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> global_spotify_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: left;">country</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Từng Quen</td>
<td style="text-align: left;">Wren Evans</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">0.246</td>
<td style="text-align: right;">-16.913</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">77.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Standing Next to You</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-4.389</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">106.017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Like Crazy</td>
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">-5.445</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">120.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seven (feat. Latto) (Explicit Ver.)</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.831</td>
<td style="text-align: right;">-4.185</td>
<td style="text-align: right;">0.872</td>
<td style="text-align: right;">124.987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Slow Dancing</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">-7.758</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">155.960</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hit Me Up (feat. Nomovodka)</td>
<td style="text-align: left;">Binz</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">-9.050</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">99.993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anh Là Ngoại Lệ Của Em</td>
<td style="text-align: left;">Phương Ly</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">-5.958</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">111.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bạn Đời</td>
<td style="text-align: left;">Karik</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">-8.246</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">129.987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Đánh Đổi (ft. RPT MCK)</td>
<td style="text-align: left;">Obito</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">-12.294</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">76.876</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lệ Lưu Ly</td>
<td style="text-align: left;">Vũ Phụng Tiên</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.771</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">-10.909</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">94.997</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="import-wrangle-dataset-3---world-data-2023-kaggle" class="level2">
<h2 class="anchored" data-anchor-id="import-wrangle-dataset-3---world-data-2023-kaggle">Import &amp; Wrangle Dataset 3 - World Data 2023 (Kaggle)<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-wrangle-dataset-3---world-data-2023-kaggle" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> world_data_2023 <span class="kw">AS</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> read_csv(<span class="st">'world_data_2023.csv'</span>, strict_mode<span class="op">=</span><span class="kw">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> world_data_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p>Table: Displaying records 1 - 10</p>
<p>|Country |Density (P/Km2) |Abbreviation |Agricultural Land( %) |Land 
Area(Km2) |Armed Forces size | Birth Rate| Calling Code|Capital/Major 
City |Co2-Emissions |CPI |CPI Change (%) |Currency-Code | Fertility 
Rate|Forested Area (%) |Gasoline Price |GDP |Gross primary education 
enrollment (%) |Gross tertiary education enrollment (%) | Infant 
mortality|Largest city | Life expectancy| Maternal mortality 
ratio|Minimum wage |Official language |Out of pocket health expenditure |
 Physicians per thousand|Population |Population: Labor force 
participation (%) |Tax revenue (%) |Total tax rate |Unemployment rate 
|Urban_population | Latitude| Longitude| 
|:——————-|:————–|:————|:———————|:————–|:—————–|———-:|————:|:———————-|:
————-|:——|:————–|:————-|————–:|:—————–|:————–|:——————|:————————————–|:
—————————————|—————-:|:———————-|—————:|————————:|:————|:—————–|:
——————————–|———————–:|:———-|:—————————————–|:—————|:————–|:—————–|:
—————-|———:|———-:| |Afghanistan |60 |AF |58.10% |652,230 |323,000 | 
32.49| 93|Kabul |8,672 |149.9 |2.30% |AFN | 4.47|2.10% |$0.70 
|$19,101,353,833 |104.00% |9.70% | 47.9|Kabul | 64.5| 638|$0.43 |Pashto 
|78.40% | 0.28|38,041,754 |48.90% |9.30% |71.40% |11.12% |9,797,273 | 
33.93911| 67.709953| |Albania |105 |AL |43.10% |28,748 |9,000 | 11.78| 
355|Tirana |4,536 |119.05 |1.40% |ALL | 1.62|28.10% |$1.36 
|$15,278,077,447 |107.00% |55.00% | 7.8|Tirana | 78.5| 15|$1.12 
|Albanian |56.90% | 1.20|2,854,191 |55.70% |18.60% |36.60% |12.33% 
|1,747,593 | 41.15333| 20.168331| |Algeria |18 |DZ |17.40% |2,381,741 
|317,000 | 24.28| 213|Algiers |150,006 |151.36 |2.00% |DZD | 3.02|0.80% 
|$0.28 |$169,988,236,398 |109.90% |51.40% | 20.1|Algiers | 76.7| 
112|$0.95 |Arabic |28.10% | 1.72|43,053,054 |41.20% |37.20% |66.10% 
|11.70% |31,510,100 | 28.03389| 1.659626| |Andorra |164 |AD |40.00% |468
 |NA | 7.20| 376|Andorra la Vella |469 |NA |NA |EUR | 1.27|34.00% |$1.51
 |$3,154,057,987 |106.40% |NA | 2.7|Andorra la Vella | NA| NA|$6.63 
|Catalan |36.40% | 3.33|77,142 |NA |NA |NA |NA |67,873 | 42.50628| 
1.521801| |Angola |26 |AO |47.50% |1,246,700 |117,000 | 40.73| 
244|Luanda |34,693 |261.73 |17.10% |AOA | 5.52|46.30% |$0.97 
|$94,635,415,870 |113.50% |9.30% | 51.6|Luanda | 60.8| 241|$0.71 
|Portuguese |33.40% | 0.21|31,825,295 |77.50% |9.20% |49.10% |6.89% 
|21,061,025 | -11.20269| 17.873887| |Antigua and Barbuda |223 |AG 
|20.50% |443 |0 | 15.33| 1|St.&nbsp;John’s, Saint John |557 |113.81 
|1.20% |XCD | 1.99|22.30% |$0.99 |$1,727,759,259 |105.00% |24.80% | 
5.0|St.&nbsp;John’s, Saint John | 76.9| 42|$3.04 |English |24.30% | 
2.76|97,118 |NA |16.50% |43.00% |NA |23,800 | 17.06082| -61.796428| 
|Argentina |17 |AR |54.30% |2,780,400 |105,000 | 17.02| 54|Buenos Aires 
|201,348 |232.75 |53.50% |ARS | 2.26|9.80% |$1.10 |$449,663,446,954 
|109.70% |90.00% | 8.8|Buenos Aires | 76.5| 39|$3.35 |Spanish |17.60% | 
3.96|44,938,712 |61.30% |10.10% |106.30% |9.79% |41,339,571 | -38.41610|
 -63.616672| |Armenia |104 |AM |58.90% |29,743 |49,000 | 13.99| 
374|Yerevan |5,156 |129.18 |1.40% |AMD | 1.76|11.70% |$0.77 
|$13,672,802,158 |92.70% |54.60% | 11.0|Yerevan | 74.9| 26|$0.66 
|Armenian |81.60% | 4.40|2,957,731 |55.60% |20.90% |22.60% |16.99% 
|1,869,848 | 40.06910| 45.038189| |Australia |3 |AU |48.20% |7,741,220 
|58,000 | 12.60| 61|Canberra |375,908 |119.8 |1.60% |AUD | 1.74|16.30% 
|$0.93 |$1,392,680,589,329 |100.30% |113.10% | 3.1|Sydney | 82.7| 
6|$13.59 |None |19.60% | 3.68|25,766,605 |65.50% |23.00% |47.40% |5.27% 
|21,844,756 | -25.27440| 133.775136| |Austria |109 |AT |32.40% |83,871 
|21,000 | 9.70| 43|Vienna |61,448 |118.06 |1.50% |EUR | 1.47|46.90% 
|$1.20 |$446,314,739,528 |103.10% |85.10% | 2.9|Vienna | 81.6| 5|NA 
|German |17.90% | 5.17|8,877,067 |60.70% |25.40% |51.40% |4.67% 
|5,194,416 | 47.51623| 14.550072|</p>
</div>
</div>
</section>
<section id="select-county-and-abbreviation-columns-only-and-assign-it-to-a-new-table" class="level2">
<h2 class="anchored" data-anchor-id="select-county-and-abbreviation-columns-only-and-assign-it-to-a-new-table">Select County and Abbreviation columns only and assign it to a new table<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#select-county-and-abbreviation-columns-only-and-assign-it-to-a-new-table" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> abbreviation_table <span class="kw">AS</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> Country <span class="kw">AS</span> country,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         Abbreviation <span class="kw">AS</span> abbreviation</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> world_data_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> abbreviation_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">abbreviation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: left;">AF</td>
</tr>
<tr class="even">
<td style="text-align: left;">Albania</td>
<td style="text-align: left;">AL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Algeria</td>
<td style="text-align: left;">DZ</td>
</tr>
<tr class="even">
<td style="text-align: left;">Andorra</td>
<td style="text-align: left;">AD</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Angola</td>
<td style="text-align: left;">AO</td>
</tr>
<tr class="even">
<td style="text-align: left;">Antigua and Barbuda</td>
<td style="text-align: left;">AG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Argentina</td>
<td style="text-align: left;">AR</td>
</tr>
<tr class="even">
<td style="text-align: left;">Armenia</td>
<td style="text-align: left;">AM</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Australia</td>
<td style="text-align: left;">AU</td>
</tr>
<tr class="even">
<td style="text-align: left;">Austria</td>
<td style="text-align: left;">AT</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="import-wrangle-dataset-4---weekly-charts-of-october-16-2025-kworb" class="level2">
<h2 class="anchored" data-anchor-id="import-wrangle-dataset-4---weekly-charts-of-october-16-2025-kworb">Import &amp; Wrangle Dataset 4 - Weekly Charts of October 16, 2025 (Kworb)<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-wrangle-dataset-4---weekly-charts-of-october-16-2025-kworb" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="new-zealand-dataset-import-weekly-chart-of-new-zealand-and-remove-all-columns-except-for-the-artist-and-title-column.-separate-artist-and-song-title-from-the-artist.and.title-column" class="level2">
<h2 class="anchored" data-anchor-id="new-zealand-dataset-import-weekly-chart-of-new-zealand-and-remove-all-columns-except-for-the-artist-and-title-column.-separate-artist-and-song-title-from-the-artist.and.title-column">New
 Zealand Dataset – Import weekly chart of New Zealand and remove all 
columns except for the Artist and Title column. – Separate artist and 
song title from the Artist.and.Title column<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#new-zealand-dataset-import-weekly-chart-of-new-zealand-and-remove-all-columns-except-for-the-artist-and-title-column.-separate-artist-and-song-title-from-the-artist.and.title-column" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_10_16_25 <span class="kw">AS</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> read_csv(<span class="st">'10_16_25_new_zealand.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_10_16_25</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 60%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Pos</th>
<th style="text-align: left;">P+</th>
<th style="text-align: left;">Artist and Title</th>
<th style="text-align: right;">Wks</th>
<th style="text-align: right;">Pk</th>
<th style="text-align: left;">(x?)</th>
<th style="text-align: left;">Streams</th>
<th style="text-align: left;">Streams+</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Taylor Swift - The Fate of Ophelia</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x2)</td>
<td style="text-align: left;">557,641</td>
<td style="text-align: left;">-209,482</td>
<td style="text-align: left;">1,324,764</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">+2</td>
<td style="text-align: left;">Olivia Dean - Man I Need</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x3)</td>
<td style="text-align: left;">520,933</td>
<td style="text-align: left;">+8,176</td>
<td style="text-align: left;">3,442,322</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">Taylor Swift - Opalite</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">(x1)</td>
<td style="text-align: left;">398,866</td>
<td style="text-align: left;">-188,844</td>
<td style="text-align: left;">986,576</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">+10</td>
<td style="text-align: left;">HUNTR/X - Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast)</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x8)</td>
<td style="text-align: left;">358,810</td>
<td style="text-align: left;">+10,345</td>
<td style="text-align: left;">5,945,571</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">-2</td>
<td style="text-align: left;">Taylor Swift - Elizabeth Taylor</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">(x1)</td>
<td style="text-align: left;">300,260</td>
<td style="text-align: left;">-259,488</td>
<td style="text-align: left;">860,008</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">Taylor Swift - Father Figure</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">266,299</td>
<td style="text-align: left;">-239,876</td>
<td style="text-align: left;">772,474</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Taylor Swift - The Life of a Showgirl (w/ Sabrina Carpenter)</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">241,734</td>
<td style="text-align: left;">-193,617</td>
<td style="text-align: left;">677,085</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">+7</td>
<td style="text-align: left;">Disco Lines - No Broke Boys (w/ Tinashe)</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">(x1)</td>
<td style="text-align: left;">236,431</td>
<td style="text-align: left;">+6,062</td>
<td style="text-align: left;">3,538,014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">-3</td>
<td style="text-align: left;">Taylor Swift - Wood</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">233,495</td>
<td style="text-align: left;">-208,709</td>
<td style="text-align: left;">675,699</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">+6</td>
<td style="text-align: left;">Alex Warren - Ordinary</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x16)</td>
<td style="text-align: left;">232,012</td>
<td style="text-align: left;">+5,319</td>
<td style="text-align: left;">9,631,423</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="only-keep-the-first-artist" class="level2">
<h2 class="anchored" data-anchor-id="only-keep-the-first-artist">Only keep the first artist<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#only-keep-the-first-artist" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="for-smoother-joins-change-following" class="level2">
<h2 class="anchored" data-anchor-id="for-smoother-joins-change-following">For smoother joins, change following:<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#for-smoother-joins-change-following" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="remove-any-white-space-before-and-after-the-title-and-artist-columns" class="level2">
<h2 class="anchored" data-anchor-id="remove-any-white-space-before-and-after-the-title-and-artist-columns">Remove any white space before and after the title and artist columns<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-any-white-space-before-and-after-the-title-and-artist-columns" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="change-the-case-to-all-lowercase-for-both-title-and-artist-columns" class="level2">
<h2 class="anchored" data-anchor-id="change-the-case-to-all-lowercase-for-both-title-and-artist-columns">Change the case to all lowercase for both title and artist columns<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#change-the-case-to-all-lowercase-for-both-title-and-artist-columns" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_25_1 <span class="kw">AS</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">SUBSTR</span>(<span class="ot">"Artist and Title"</span>, <span class="dv">1</span>, STRPOS(<span class="ot">"Artist and Title"</span>, <span class="st">'-'</span>) <span class="op">-</span> <span class="dv">1</span>)) <span class="kw">AS</span> artist,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">SUBSTR</span>(<span class="ot">"Artist and Title"</span>, STRPOS(<span class="ot">"Artist and Title"</span>, <span class="st">'-'</span>) <span class="op">+</span> <span class="dv">1</span>)) <span class="kw">AS</span> title</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> new_zealand_10_16_25</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_25_1</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> artist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AC/DC</td>
<td style="text-align: left;">Thunderstruck</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Bloodline (w/ Jelly Roll)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Eternity</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Ordinary</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Carry You Home</td>
</tr>
<tr class="even">
<td style="text-align: left;">Benson Boone</td>
<td style="text-align: left;">Mystical Magical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Benson Boone</td>
<td style="text-align: left;">Beautiful Things</td>
</tr>
<tr class="even">
<td style="text-align: left;">Billie Eilish</td>
<td style="text-align: left;">WILDFLOWER</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Billie Eilish</td>
<td style="text-align: left;">BIRDS OF A FEATHER</td>
</tr>
<tr class="even">
<td style="text-align: left;">Billy Joel</td>
<td style="text-align: left;">Piano Man</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_25_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">The Fate of Ophelia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Olivia Dean</td>
<td style="text-align: left;">Man I Need</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Opalite</td>
</tr>
<tr class="even">
<td style="text-align: left;">HUNTR/X</td>
<td style="text-align: left;">Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Elizabeth Taylor</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Father Figure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">The Life of a Showgirl (w/ Sabrina Carpenter)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disco Lines</td>
<td style="text-align: left;">No Broke Boys (w/ Tinashe)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Wood</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Ordinary</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Only keep the first artist</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> new_zealand_25_2;</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_25_2 <span class="kw">AS</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> STRING_SPLIT(<span class="ot">"artist"</span>, <span class="st">','</span>)[<span class="dv">1</span>] <span class="kw">AS</span> artist,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>          title</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> new_zealand_25_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_25_2;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">The Fate of Ophelia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Olivia Dean</td>
<td style="text-align: left;">Man I Need</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Opalite</td>
</tr>
<tr class="even">
<td style="text-align: left;">HUNTR/X</td>
<td style="text-align: left;">Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Elizabeth Taylor</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Father Figure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">The Life of a Showgirl (w/ Sabrina Carpenter)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disco Lines</td>
<td style="text-align: left;">No Broke Boys (w/ Tinashe)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taylor Swift</td>
<td style="text-align: left;">Wood</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Ordinary</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- For smoother joins, change following:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Remove any white space before and after the title and artist columns</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Change the case to all lowercase for both title and artist columns</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> new_zealand_25_clean;</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_25_clean <span class="kw">AS</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(artist)) <span class="kw">AS</span> artist,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(title)) <span class="kw">AS</span> title,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> new_zealand_25_2;</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_25_clean;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">taylor swift</td>
<td style="text-align: left;">the fate of ophelia</td>
</tr>
<tr class="even">
<td style="text-align: left;">olivia dean</td>
<td style="text-align: left;">man i need</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taylor swift</td>
<td style="text-align: left;">opalite</td>
</tr>
<tr class="even">
<td style="text-align: left;">huntr/x</td>
<td style="text-align: left;">golden (w/ ejae, audrey nuna, rei ami, kpop demon hunters cast)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taylor swift</td>
<td style="text-align: left;">elizabeth taylor</td>
</tr>
<tr class="even">
<td style="text-align: left;">taylor swift</td>
<td style="text-align: left;">father figure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taylor swift</td>
<td style="text-align: left;">the life of a showgirl (w/ sabrina carpenter)</td>
</tr>
<tr class="even">
<td style="text-align: left;">disco lines</td>
<td style="text-align: left;">no broke boys (w/ tinashe)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taylor swift</td>
<td style="text-align: left;">wood</td>
</tr>
<tr class="even">
<td style="text-align: left;">alex warren</td>
<td style="text-align: left;">ordinary</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="south-korea-dataset" class="level2">
<h2 class="anchored" data-anchor-id="south-korea-dataset">South Korea Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#south-korea-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="import-weekly-chart-of-south-korea-and-remove-all-columns-except-for-the-artist.and.title-column" class="level2">
<h2 class="anchored" data-anchor-id="import-weekly-chart-of-south-korea-and-remove-all-columns-except-for-the-artist.and.title-column">Import weekly chart of South Korea and remove all columns except for the Artist.and.Title column<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-weekly-chart-of-south-korea-and-remove-all-columns-except-for-the-artist.and.title-column" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="separate-artist-and-song-title-from-the-artist.and.title-column" class="level2">
<h2 class="anchored" data-anchor-id="separate-artist-and-song-title-from-the-artist.and.title-column">Separate artist and song title from the Artist.and.Title column<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#separate-artist-and-song-title-from-the-artist.and.title-column" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> korea_10_16_25;</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_10_16_25 <span class="kw">AS</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> read_csv(<span class="st">'10_16_25_korea.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_10_16_25</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 60%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Pos</th>
<th style="text-align: left;">P+</th>
<th style="text-align: left;">Artist and Title</th>
<th style="text-align: right;">Wks</th>
<th style="text-align: right;">Pk</th>
<th style="text-align: left;">(x?)</th>
<th style="text-align: left;">Streams</th>
<th style="text-align: left;">Streams+</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Kenshi Yonezu - IRIS OUT</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x2)</td>
<td style="text-align: left;">897,818</td>
<td style="text-align: left;">+56,057</td>
<td style="text-align: left;">3,189,571</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Jimin - Who</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x62)</td>
<td style="text-align: left;">809,298</td>
<td style="text-align: left;">+11,882</td>
<td style="text-align: left;">81,048,887</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Kenshi Yonezu - JANE DOE (w/ Hikaru Utada)</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">(x2)</td>
<td style="text-align: left;">672,581</td>
<td style="text-align: left;">+67,518</td>
<td style="text-align: left;">1,761,056</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">+1</td>
<td style="text-align: left;">Jin - Don’t Say You Love Me</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">(x8)</td>
<td style="text-align: left;">406,781</td>
<td style="text-align: left;">+28,137</td>
<td style="text-align: left;">10,691,584</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">Jimin - Be Mine</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">(x9)</td>
<td style="text-align: left;">337,182</td>
<td style="text-align: left;">-44,135</td>
<td style="text-align: left;">22,351,357</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">HUNTR/X - Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast)</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x1)</td>
<td style="text-align: left;">301,783</td>
<td style="text-align: left;">-35,872</td>
<td style="text-align: left;">8,838,075</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Jung Kook - Seven (w/ Latto)</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x16)</td>
<td style="text-align: left;">276,478</td>
<td style="text-align: left;">+3,118</td>
<td style="text-align: left;">56,168,772</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">+2</td>
<td style="text-align: left;">Kenshi Yonezu - KICK BACK</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">234,681</td>
<td style="text-align: left;">+21,456</td>
<td style="text-align: left;">4,357,070</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">데이먼스 이어 Damons year - yours</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">225,555</td>
<td style="text-align: left;">-4,163</td>
<td style="text-align: left;">9,871,133</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">+1</td>
<td style="text-align: left;">BLACKPINK - JUMP</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">(x4)</td>
<td style="text-align: left;">197,731</td>
<td style="text-align: left;">-13,554</td>
<td style="text-align: left;">5,298,371</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="only-keep-the-first-artist-1" class="level2">
<h2 class="anchored" data-anchor-id="only-keep-the-first-artist-1">Only keep the first artist<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#only-keep-the-first-artist-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="for-smoother-joins-change-following-1" class="level2">
<h2 class="anchored" data-anchor-id="for-smoother-joins-change-following-1">For smoother joins, change following:<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#for-smoother-joins-change-following-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="remove-any-white-space-before-and-after-the-title-and-artist-columns-1" class="level2">
<h2 class="anchored" data-anchor-id="remove-any-white-space-before-and-after-the-title-and-artist-columns-1">Remove any white space before and after the title and artist columns<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-any-white-space-before-and-after-the-title-and-artist-columns-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="change-the-case-to-all-lowercase-for-both-title-and-artist-columns-1" class="level2">
<h2 class="anchored" data-anchor-id="change-the-case-to-all-lowercase-for-both-title-and-artist-columns-1">Change the case to all lowercase for both title and artist columns<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#change-the-case-to-all-lowercase-for-both-title-and-artist-columns-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> korea_25_1;</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_25_1 <span class="kw">AS</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">SUBSTR</span>(<span class="ot">"Artist and Title"</span>, <span class="dv">1</span>, STRPOS(<span class="ot">"Artist and Title"</span>, <span class="st">'-'</span>) <span class="op">-</span> <span class="dv">1</span>)) <span class="kw">AS</span> artist,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">SUBSTR</span>(<span class="ot">"Artist and Title"</span>, STRPOS(<span class="ot">"Artist and Title"</span>, <span class="st">'-'</span>) <span class="op">+</span> <span class="dv">1</span>)) <span class="kw">AS</span> title</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> korea_10_16_25</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_25_1</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> artist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">#Annyeong</td>
<td style="text-align: left;">Dial Your Number</td>
</tr>
<tr class="even">
<td style="text-align: left;">AKMU</td>
<td style="text-align: left;">How can I love the heartbreak, you’re the one I love</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALLDAY PROJECT</td>
<td style="text-align: left;">WICKED</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALLDAY PROJECT</td>
<td style="text-align: left;">FAMOUS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AiNA THE END</td>
<td style="text-align: left;">革命道中 - On The Way</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aimyon</td>
<td style="text-align: left;">愛を伝えたいだとか</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BABYMONSTER</td>
<td style="text-align: left;">WE GO UP</td>
</tr>
<tr class="even">
<td style="text-align: left;">BIG Naughty</td>
<td style="text-align: left;">Vancouver</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BLACKPINK</td>
<td style="text-align: left;">JUMP</td>
</tr>
<tr class="even">
<td style="text-align: left;">BOOHWAL</td>
<td style="text-align: left;">Never Ending Story</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_25_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kenshi Yonezu</td>
<td style="text-align: left;">IRIS OUT</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">Who</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kenshi Yonezu</td>
<td style="text-align: left;">JANE DOE (w/ Hikaru Utada)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jin</td>
<td style="text-align: left;">Don’t Say You Love Me</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">Be Mine</td>
</tr>
<tr class="even">
<td style="text-align: left;">HUNTR/X</td>
<td style="text-align: left;">Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">Seven (w/ Latto)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kenshi Yonezu</td>
<td style="text-align: left;">KICK BACK</td>
</tr>
<tr class="odd">
<td style="text-align: left;">데이먼스 이어 Damons year</td>
<td style="text-align: left;">yours</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLACKPINK</td>
<td style="text-align: left;">JUMP</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Only keep the first artist</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> korea_25_2;</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_25_2 <span class="kw">AS</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> STRING_SPLIT(<span class="ot">"artist"</span>, <span class="st">','</span>)[<span class="dv">1</span>] <span class="kw">AS</span> artist,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>          title</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> korea_25_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_25_2;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kenshi Yonezu</td>
<td style="text-align: left;">IRIS OUT</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">Who</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kenshi Yonezu</td>
<td style="text-align: left;">JANE DOE (w/ Hikaru Utada)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jin</td>
<td style="text-align: left;">Don’t Say You Love Me</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">Be Mine</td>
</tr>
<tr class="even">
<td style="text-align: left;">HUNTR/X</td>
<td style="text-align: left;">Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">Seven (w/ Latto)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kenshi Yonezu</td>
<td style="text-align: left;">KICK BACK</td>
</tr>
<tr class="odd">
<td style="text-align: left;">데이먼스 이어 Damons year</td>
<td style="text-align: left;">yours</td>
</tr>
<tr class="even">
<td style="text-align: left;">BLACKPINK</td>
<td style="text-align: left;">JUMP</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> korea_25_clean;</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_25_clean <span class="kw">AS</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(title)) <span class="kw">AS</span> title,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(artist)) <span class="kw">AS</span> artist</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> korea_25_2;</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_25_clean;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 71%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">iris out</td>
<td style="text-align: left;">kenshi yonezu</td>
</tr>
<tr class="even">
<td style="text-align: left;">who</td>
<td style="text-align: left;">jimin</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jane doe (w/ hikaru utada)</td>
<td style="text-align: left;">kenshi yonezu</td>
</tr>
<tr class="even">
<td style="text-align: left;">don’t say you love me</td>
<td style="text-align: left;">jin</td>
</tr>
<tr class="odd">
<td style="text-align: left;">be mine</td>
<td style="text-align: left;">jimin</td>
</tr>
<tr class="even">
<td style="text-align: left;">golden (w/ ejae, audrey nuna, rei ami, kpop demon hunters cast)</td>
<td style="text-align: left;">huntr/x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">seven (w/ latto)</td>
<td style="text-align: left;">jung kook</td>
</tr>
<tr class="even">
<td style="text-align: left;">kick back</td>
<td style="text-align: left;">kenshi yonezu</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yours</td>
<td style="text-align: left;">데이먼스 이어 damons year</td>
</tr>
<tr class="even">
<td style="text-align: left;">jump</td>
<td style="text-align: left;">blackpink</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="usa-dataset" class="level4">
<h4 class="anchored" data-anchor-id="usa-dataset">USA Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#usa-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
</section>
<section id="import-weekly-chart" class="level2">
<h2 class="anchored" data-anchor-id="import-weekly-chart">Import weekly chart<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-weekly-chart" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_10_16_25 <span class="kw">AS</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> read_csv(<span class="st">'10_16_25_usa.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_10_16_25</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> <span class="ot">"Artist and Title"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 64%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Pos</th>
<th style="text-align: left;">P+</th>
<th style="text-align: left;">Artist and Title</th>
<th style="text-align: right;">Wks</th>
<th style="text-align: right;">Pk</th>
<th style="text-align: left;">(x?)</th>
<th style="text-align: left;">Streams</th>
<th style="text-align: left;">Streams+</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">192</td>
<td style="text-align: left;">-11</td>
<td style="text-align: left;">A$AP Rocky - I Smoked Away My Brain (I’m God x Demons Mashup) (w/ Imogen Heap, Clams Casino)</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">78</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2,074,974</td>
<td style="text-align: left;">-93,550</td>
<td style="text-align: left;">110,614,023</td>
</tr>
<tr class="even">
<td style="text-align: right;">164</td>
<td style="text-align: left;">-14</td>
<td style="text-align: left;">Alex Warren - Eternity</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2,215,973</td>
<td style="text-align: left;">-98,586</td>
<td style="text-align: left;">48,070,751</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: left;">=</td>
<td style="text-align: left;">Alex Warren - Ordinary</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x2)</td>
<td style="text-align: left;">6,586,500</td>
<td style="text-align: left;">-52,993</td>
<td style="text-align: left;">257,372,112</td>
</tr>
<tr class="even">
<td style="text-align: right;">68</td>
<td style="text-align: left;">+6</td>
<td style="text-align: left;">Arctic Monkeys - 505</td>
<td style="text-align: right;">247</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3,145,316</td>
<td style="text-align: left;">+11,498</td>
<td style="text-align: left;">687,846,529</td>
</tr>
<tr class="odd">
<td style="text-align: right;">159</td>
<td style="text-align: left;">+31</td>
<td style="text-align: left;">Arctic Monkeys - I Wanna Be Yours</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">62</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2,249,580</td>
<td style="text-align: left;">+107,384</td>
<td style="text-align: left;">342,976,460</td>
</tr>
<tr class="even">
<td style="text-align: right;">81</td>
<td style="text-align: left;">+2</td>
<td style="text-align: left;">Ariana Grande - we can’t be friends (wait for your love)</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">(x2)</td>
<td style="text-align: left;">2,976,337</td>
<td style="text-align: left;">+41,514</td>
<td style="text-align: left;">309,352,920</td>
</tr>
<tr class="odd">
<td style="text-align: right;">79</td>
<td style="text-align: left;">-32</td>
<td style="text-align: left;">Bad Bunny - BAILE INoLVIDABLE</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">(x1)</td>
<td style="text-align: left;">2,998,460</td>
<td style="text-align: left;">-833,368</td>
<td style="text-align: left;">163,779,963</td>
</tr>
<tr class="even">
<td style="text-align: right;">33</td>
<td style="text-align: left;">-9</td>
<td style="text-align: left;">Bad Bunny - DtMF</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">(x3)</td>
<td style="text-align: left;">4,462,377</td>
<td style="text-align: left;">-480,919</td>
<td style="text-align: left;">217,729,028</td>
</tr>
<tr class="odd">
<td style="text-align: right;">80</td>
<td style="text-align: left;">-29</td>
<td style="text-align: left;">Bad Bunny - EoO</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2,986,094</td>
<td style="text-align: left;">-734,113</td>
<td style="text-align: left;">130,921,841</td>
</tr>
<tr class="even">
<td style="text-align: right;">72</td>
<td style="text-align: left;">-23</td>
<td style="text-align: left;">Bad Bunny - NUEVAYoL</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">(x1)</td>
<td style="text-align: left;">3,088,667</td>
<td style="text-align: left;">-699,432</td>
<td style="text-align: left;">149,117,020</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="only-keep-the-first-artist-2" class="level2">
<h2 class="anchored" data-anchor-id="only-keep-the-first-artist-2">Only keep the first artist<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#only-keep-the-first-artist-2" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="for-smoother-joins-change-following-2" class="level2">
<h2 class="anchored" data-anchor-id="for-smoother-joins-change-following-2">For smoother joins, change following:<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#for-smoother-joins-change-following-2" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="remove-any-white-space-before-and-after-the-title-and-artist-columns-2" class="level2">
<h2 class="anchored" data-anchor-id="remove-any-white-space-before-and-after-the-title-and-artist-columns-2">Remove any white space before and after the title and artist columns<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-any-white-space-before-and-after-the-title-and-artist-columns-2" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="change-the-case-to-all-lowercase-for-both-title-and-artist-columns-2" class="level2">
<h2 class="anchored" data-anchor-id="change-the-case-to-all-lowercase-for-both-title-and-artist-columns-2">Change the case to all lowercase for both title and artist columns<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#change-the-case-to-all-lowercase-for-both-title-and-artist-columns-2" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_25_1 <span class="kw">AS</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">SUBSTR</span>(<span class="ot">"Artist and Title"</span>, <span class="dv">1</span>, STRPOS(<span class="ot">"Artist and Title"</span>, <span class="st">'-'</span>) <span class="op">-</span> <span class="dv">1</span>)) <span class="kw">AS</span> artist,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">SUBSTR</span>(<span class="ot">"Artist and Title"</span>, STRPOS(<span class="ot">"Artist and Title"</span>, <span class="st">'-'</span>) <span class="op">+</span> <span class="dv">1</span>)) <span class="kw">AS</span> title</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> usa_10_16_25</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_25_1</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> artist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A$AP Rocky</td>
<td style="text-align: left;">I Smoked Away My Brain (I’m God x Demons Mashup) (w/ Imogen Heap, Clams Casino)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Eternity</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Ordinary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arctic Monkeys</td>
<td style="text-align: left;">I Wanna Be Yours</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Arctic Monkeys</td>
<td style="text-align: left;">505</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ariana Grande</td>
<td style="text-align: left;">we can’t be friends (wait for your love)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">DtMF</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">BAILE INoLVIDABLE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">EoO</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">NUEVAYoL</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_25_1</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> artist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A$AP Rocky</td>
<td style="text-align: left;">I Smoked Away My Brain (I’m God x Demons Mashup) (w/ Imogen Heap, Clams Casino)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Eternity</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Ordinary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arctic Monkeys</td>
<td style="text-align: left;">I Wanna Be Yours</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Arctic Monkeys</td>
<td style="text-align: left;">505</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ariana Grande</td>
<td style="text-align: left;">we can’t be friends (wait for your love)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">DtMF</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">BAILE INoLVIDABLE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">EoO</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">NUEVAYoL</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Only keep the first artist</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> usa_25_2;</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_25_2 <span class="kw">AS</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> STRING_SPLIT(<span class="ot">"artist"</span>, <span class="st">','</span>)[<span class="dv">1</span>] <span class="kw">AS</span> artist,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>          title</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> usa_25_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_25_2</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> artist;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A$AP Rocky</td>
<td style="text-align: left;">I Smoked Away My Brain (I’m God x Demons Mashup) (w/ Imogen Heap, Clams Casino)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Eternity</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alex Warren</td>
<td style="text-align: left;">Ordinary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arctic Monkeys</td>
<td style="text-align: left;">I Wanna Be Yours</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Arctic Monkeys</td>
<td style="text-align: left;">505</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ariana Grande</td>
<td style="text-align: left;">we can’t be friends (wait for your love)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">DtMF</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">BAILE INoLVIDABLE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">EoO</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bad Bunny</td>
<td style="text-align: left;">NUEVAYoL</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> usa_25_clean;</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_25_clean <span class="kw">AS</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(title)) <span class="kw">AS</span> title,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(artist)) <span class="kw">AS</span> artist</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> usa_25_2;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_25_clean</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> artist;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 84%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i smoked away my brain (i’m god x demons mashup) (w/ imogen heap, clams casino)</td>
<td style="text-align: left;">a$ap rocky</td>
</tr>
<tr class="even">
<td style="text-align: left;">eternity</td>
<td style="text-align: left;">alex warren</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ordinary</td>
<td style="text-align: left;">alex warren</td>
</tr>
<tr class="even">
<td style="text-align: left;">505</td>
<td style="text-align: left;">arctic monkeys</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i wanna be yours</td>
<td style="text-align: left;">arctic monkeys</td>
</tr>
<tr class="even">
<td style="text-align: left;">we can’t be friends (wait for your love)</td>
<td style="text-align: left;">ariana grande</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dtmf</td>
<td style="text-align: left;">bad bunny</td>
</tr>
<tr class="even">
<td style="text-align: left;">baile inolvidable</td>
<td style="text-align: left;">bad bunny</td>
</tr>
<tr class="odd">
<td style="text-align: left;">eoo</td>
<td style="text-align: left;">bad bunny</td>
</tr>
<tr class="even">
<td style="text-align: left;">nuevayol</td>
<td style="text-align: left;">bad bunny</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="import-dataset-5-2025-spotify-dataset" class="level3">
<h3 class="anchored" data-anchor-id="import-dataset-5-2025-spotify-dataset">Import Dataset 5: 2025 Spotify dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#import-dataset-5-2025-spotify-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> universal_spotify;</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> universal_spotify <span class="kw">AS</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> name <span class="kw">AS</span> title,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>         artists <span class="kw">AS</span> artist,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>         danceability,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>         energy,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>         loudness,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>         valence,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>         tempo</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> read_csv(<span class="st">'universal_top_spotify_songs_25.csv'</span>, ignore_errors<span class="op">=</span><span class="kw">true</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> universal_spotify</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="kw">IN</span> (<span class="st">'One Dance'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="even">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="even">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="even">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="even">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
<tr class="even">
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake, Wizkid, Kyla</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">-5.609</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">103.967</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> spotify_2025_sql_1;</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> spotify_2025_sql_1 <span class="kw">AS</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> title,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>         STRING_SPLIT(artist, <span class="st">','</span>)[<span class="dv">1</span>] <span class="kw">AS</span> artist,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>         danceability,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>         energy,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>         loudness,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>         valence,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>         tempo</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> universal_spotify;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> spotify_2025_sql_1</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> artist <span class="kw">IN</span>(<span class="st">'Sabrina Carpenter'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 18%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Manchild</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.731</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">-5.087</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">123.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Espresso</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">-5.282</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">103.963</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Manchild</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.731</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">-5.087</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">123.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Manchild</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.731</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">-5.087</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">123.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Espresso</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">-5.282</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">103.963</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taste</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">-4.086</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">112.964</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Manchild</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.731</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">-5.087</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">123.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Manchild</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.731</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">-5.087</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">123.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Espresso</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">-5.282</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">103.963</td>
</tr>
<tr class="even">
<td style="text-align: left;">Manchild</td>
<td style="text-align: left;">Sabrina Carpenter</td>
<td style="text-align: right;">0.731</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">-5.087</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">123.010</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> spotify_2025_sql;</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> spotify_2025_sql <span class="kw">AS</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(title)) <span class="kw">AS</span> title,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">TRIM</span>(<span class="fu">LOWER</span>(artist)) <span class="kw">AS</span> artist,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         danceability,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         energy,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         loudness,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>         valence,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>         tempo</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_2025_sql_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> spotify_2025_sql</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> artist <span class="kw">IN</span> (<span class="st">'earth'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">je mi fajn 2</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.819</td>
<td style="text-align: right;">0.643</td>
<td style="text-align: right;">-5.400</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">90.462</td>
</tr>
<tr class="even">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="odd">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="even">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="odd">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="even">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="odd">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="even">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="odd">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
<tr class="even">
<td style="text-align: left;">september</td>
<td style="text-align: left;">earth</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">-7.892</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">125.996</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="combine-dataset-2-and-3" class="level2">
<h2 class="anchored" data-anchor-id="combine-dataset-2-and-3">Combine dataset 2 and 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#combine-dataset-2-and-3" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<section id="replace-country-abbreviation-with-its-full-name" class="level4">
<h4 class="anchored" data-anchor-id="replace-country-abbreviation-with-its-full-name">Replace country abbreviation with its full name<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#replace-country-abbreviation-with-its-full-name" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="match-spotifys-country-abbreviation-with-abbreviation-tables-abbreviation" class="level4">
<h4 class="anchored" data-anchor-id="match-spotifys-country-abbreviation-with-abbreviation-tables-abbreviation">Match spotify’s country abbreviation with abbreviation table’s abbreviation<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#match-spotifys-country-abbreviation-with-abbreviation-tables-abbreviation" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="remove-any-unmatched-rows" class="level4">
<h4 class="anchored" data-anchor-id="remove-any-unmatched-rows">Remove any unmatched rows<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-any-unmatched-rows" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> spotify_global_2023_abbrev <span class="kw">AS</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> global_spotify_2023</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> abbreviation_table <span class="kw">ON</span> global_spotify_2023.country <span class="op">=</span> abbreviation_table.abbreviation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> spotify_global_2023_abbrev</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: left;">country</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
<th style="text-align: left;">country_1</th>
<th style="text-align: left;">abbreviation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Từng Quen</td>
<td style="text-align: left;">Wren Evans</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">0.246</td>
<td style="text-align: right;">-16.913</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">77.010</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="even">
<td style="text-align: left;">Standing Next to You</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-4.389</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">106.017</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Like Crazy</td>
<td style="text-align: left;">Jimin</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">-5.445</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">120.001</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seven (feat. Latto) (Explicit Ver.)</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.831</td>
<td style="text-align: right;">-4.185</td>
<td style="text-align: right;">0.872</td>
<td style="text-align: right;">124.987</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Slow Dancing</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">-7.758</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">155.960</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hit Me Up (feat. Nomovodka)</td>
<td style="text-align: left;">Binz</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">-9.050</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">99.993</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anh Là Ngoại Lệ Của Em</td>
<td style="text-align: left;">Phương Ly</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">-5.958</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">111.006</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bạn Đời</td>
<td style="text-align: left;">Karik</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">-8.246</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">129.987</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Đánh Đổi (ft. RPT MCK)</td>
<td style="text-align: left;">Obito</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">-12.294</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">76.876</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lệ Lưu Ly</td>
<td style="text-align: left;">Vũ Phụng Tiên</td>
<td style="text-align: left;">VN</td>
<td style="text-align: right;">0.771</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">-10.909</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">94.997</td>
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">VN</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="drop-abbreviation-column" class="level2">
<h2 class="anchored" data-anchor-id="drop-abbreviation-column">Drop abbreviation column<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#drop-abbreviation-column" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="rearrange-country-column-to-the-front" class="level2">
<h2 class="anchored" data-anchor-id="rearrange-country-column-to-the-front">Rearrange country column to the front<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#rearrange-country-column-to-the-front" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> spotify_global_2023_matched <span class="kw">AS</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> country_1 <span class="kw">AS</span> country,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         artist,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>         danceability,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         energy,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         loudness,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>         valence,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>         tempo</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_global_2023_abbrev</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> spotify_global_2023_matched</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Wren Evans</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">0.246</td>
<td style="text-align: right;">-16.913</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">77.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-4.389</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">106.017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Jimin</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">-5.445</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">120.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Jung Kook</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.831</td>
<td style="text-align: right;">-4.185</td>
<td style="text-align: right;">0.872</td>
<td style="text-align: right;">124.987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">-7.758</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">155.960</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Binz</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">-9.050</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">99.993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Phương Ly</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">-5.958</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">111.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Karik</td>
<td style="text-align: right;">0.843</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">-8.246</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">129.987</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Obito</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">-12.294</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">76.876</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vietnam</td>
<td style="text-align: left;">Vũ Phụng Tiên</td>
<td style="text-align: right;">0.771</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">-10.909</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">94.997</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="aggregate-danceability-energy-loudness-liveness-valence-and-tempo-by-country-for-2023-spotify-dataset" class="level4">
<h4 class="anchored" data-anchor-id="aggregate-danceability-energy-loudness-liveness-valence-and-tempo-by-country-for-2023-spotify-dataset">Aggregate danceability, energy, loudness, liveness, valence, and tempo by Country for 2023 Spotify Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#aggregate-danceability-energy-loudness-liveness-valence-and-tempo-by-country-for-2023-spotify-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="calculate-averages-of-spotify_global_2023_matched-dataset-by-country" class="level4">
<h4 class="anchored" data-anchor-id="calculate-averages-of-spotify_global_2023_matched-dataset-by-country">Calculate averages of spotify_global_2023_matched dataset by Country<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#calculate-averages-of-spotify_global_2023_matched-dataset-by-country" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> spotify_global_2023_avg <span class="kw">AS</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    country,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(danceability) <span class="kw">AS</span> danceability_avg,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(energy) <span class="kw">AS</span> energy_avg,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(loudness) <span class="kw">AS</span> loudness_avg,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(valence) <span class="kw">AS</span> valence_avg,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(tempo) <span class="kw">AS</span> tempo_avg</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_global_2023_matched</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> country;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> spotify_global_2023_avg</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Argentina</td>
<td style="text-align: right;">0.7509061</td>
<td style="text-align: right;">0.6690800</td>
<td style="text-align: right;">-5.424518</td>
<td style="text-align: right;">0.6414091</td>
<td style="text-align: right;">114.9419</td>
</tr>
<tr class="even">
<td style="text-align: left;">Australia</td>
<td style="text-align: right;">0.6423511</td>
<td style="text-align: right;">0.6331660</td>
<td style="text-align: right;">-6.949162</td>
<td style="text-align: right;">0.4968158</td>
<td style="text-align: right;">123.1089</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Austria</td>
<td style="text-align: right;">0.6821506</td>
<td style="text-align: right;">0.6496665</td>
<td style="text-align: right;">-7.024091</td>
<td style="text-align: right;">0.4935690</td>
<td style="text-align: right;">126.0647</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belarus</td>
<td style="text-align: right;">0.6857016</td>
<td style="text-align: right;">0.6608059</td>
<td style="text-align: right;">-6.556709</td>
<td style="text-align: right;">0.5190147</td>
<td style="text-align: right;">124.2886</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Belgium</td>
<td style="text-align: right;">0.6416539</td>
<td style="text-align: right;">0.6590678</td>
<td style="text-align: right;">-6.594978</td>
<td style="text-align: right;">0.5059732</td>
<td style="text-align: right;">125.7989</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bolivia</td>
<td style="text-align: right;">0.7292968</td>
<td style="text-align: right;">0.7031702</td>
<td style="text-align: right;">-5.081350</td>
<td style="text-align: right;">0.6203847</td>
<td style="text-align: right;">123.7622</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">0.6820824</td>
<td style="text-align: right;">0.7408619</td>
<td style="text-align: right;">-4.824617</td>
<td style="text-align: right;">0.6602635</td>
<td style="text-align: right;">132.1467</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulgaria</td>
<td style="text-align: right;">0.7098246</td>
<td style="text-align: right;">0.7643794</td>
<td style="text-align: right;">-5.443737</td>
<td style="text-align: right;">0.6130492</td>
<td style="text-align: right;">132.6508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Canada</td>
<td style="text-align: right;">0.6367409</td>
<td style="text-align: right;">0.6113119</td>
<td style="text-align: right;">-7.124939</td>
<td style="text-align: right;">0.4510558</td>
<td style="text-align: right;">124.9733</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chile</td>
<td style="text-align: right;">0.7699522</td>
<td style="text-align: right;">0.6934991</td>
<td style="text-align: right;">-5.786466</td>
<td style="text-align: right;">0.6230642</td>
<td style="text-align: right;">110.7299</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="join-dataset-5-to-each-countrys-dataset-for-2025-analysis" class="level2">
<h2 class="anchored" data-anchor-id="join-dataset-5-to-each-countrys-dataset-for-2025-analysis">Join Dataset 5 to Each Country’s Dataset for 2025 Analysis<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#join-dataset-5-to-each-countrys-dataset-for-2025-analysis" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<section id="new-zealand-dataset" class="level3">
<h3 class="anchored" data-anchor-id="new-zealand-dataset">New Zealand Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#new-zealand-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<section id="join-new-zealand-dataframe-and-updated-spotify-dataframe" class="level4">
<h4 class="anchored" data-anchor-id="join-new-zealand-dataframe-and-updated-spotify-dataframe">Join New Zealand dataframe and updated Spotify dataframe<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#join-new-zealand-dataframe-and-updated-spotify-dataframe" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="left-join-to-keep-all-the-rows-of-left-dataframe" class="level4">
<h4 class="anchored" data-anchor-id="left-join-to-keep-all-the-rows-of-left-dataframe">Left join to keep all the rows of left dataframe<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#left-join-to-keep-all-the-rows-of-left-dataframe" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_25_matched_sql <span class="kw">AS</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> nz.<span class="op">*</span>, s.<span class="op">*</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> new_zealand_25_clean <span class="kw">AS</span> nz</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> spotify_2025_sql <span class="kw">AS</span> s</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> nz.title <span class="op">=</span> s.title</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> nz.artist <span class="op">=</span> s.artist;</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> new_zealand_25_matched_sql</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> artist_1;</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> new_zealand_25_matched_sql</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> title_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_25_matched_sql</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">benson boone</td>
<td style="text-align: left;">beautiful things</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">-5.692</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">105.029</td>
</tr>
<tr class="even">
<td style="text-align: left;">billie eilish</td>
<td style="text-align: left;">wildflower</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;">0.247</td>
<td style="text-align: right;">-12.002</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">148.101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sabrina carpenter</td>
<td style="text-align: left;">espresso</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">-5.282</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">103.963</td>
</tr>
<tr class="even">
<td style="text-align: left;">chappell roan</td>
<td style="text-align: left;">good luck, babe!</td>
<td style="text-align: right;">0.700</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">-5.960</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">116.712</td>
</tr>
<tr class="odd">
<td style="text-align: left;">billie eilish</td>
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="even">
<td style="text-align: left;">billie eilish</td>
<td style="text-align: left;">wildflower</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;">0.247</td>
<td style="text-align: right;">-12.002</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">148.101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">the marías</td>
<td style="text-align: left;">no one noticed</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">-10.612</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">97.989</td>
</tr>
<tr class="even">
<td style="text-align: left;">sabrina carpenter</td>
<td style="text-align: left;">espresso</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">-5.282</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">103.963</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gigi perez</td>
<td style="text-align: left;">sailor song</td>
<td style="text-align: right;">0.494</td>
<td style="text-align: right;">0.413</td>
<td style="text-align: right;">-10.432</td>
<td style="text-align: right;">0.273</td>
<td style="text-align: right;">94.938</td>
</tr>
<tr class="even">
<td style="text-align: left;">gracie abrams</td>
<td style="text-align: left;">that’s so true</td>
<td style="text-align: right;">0.554</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">-4.169</td>
<td style="text-align: right;">0.372</td>
<td style="text-align: right;">108.548</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="remove-duplicate-drop-title-and-artist-columns-from-drop-duplicate-rows-and-songs-with-no-analytic-data" class="level4">
<h4 class="anchored" data-anchor-id="remove-duplicate-drop-title-and-artist-columns-from-drop-duplicate-rows-and-songs-with-no-analytic-data">Remove duplicate, drop title and artist columns from, drop duplicate rows and songs with no analytic data<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-duplicate-drop-title-and-artist-columns-from-drop-duplicate-rows-and-songs-with-no-analytic-data" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_25_matched_sql_cleaned <span class="kw">AS</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="kw">ON</span> (artist, title) <span class="op">*</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> new_zealand_25_matched_sql </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> danceability <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> artist, title</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_25_matched_sql_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 27%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">artist</th>
<th style="text-align: left;">title</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ac/dc</td>
<td style="text-align: left;">thunderstruck</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.890</td>
<td style="text-align: right;">-5.175</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">133.520</td>
</tr>
<tr class="even">
<td style="text-align: left;">alex warren</td>
<td style="text-align: left;">carry you home</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">0.660</td>
<td style="text-align: right;">-7.094</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">123.787</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alex warren</td>
<td style="text-align: left;">ordinary</td>
<td style="text-align: right;">0.368</td>
<td style="text-align: right;">0.694</td>
<td style="text-align: right;">-6.141</td>
<td style="text-align: right;">0.391</td>
<td style="text-align: right;">168.115</td>
</tr>
<tr class="even">
<td style="text-align: left;">benson boone</td>
<td style="text-align: left;">beautiful things</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">-5.692</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">105.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">benson boone</td>
<td style="text-align: left;">mystical magical</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">-3.851</td>
<td style="text-align: right;">0.848</td>
<td style="text-align: right;">119.867</td>
</tr>
<tr class="even">
<td style="text-align: left;">billie eilish</td>
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">billie eilish</td>
<td style="text-align: left;">wildflower</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;">0.247</td>
<td style="text-align: right;">-12.002</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">148.101</td>
</tr>
<tr class="even">
<td style="text-align: left;">billy joel</td>
<td style="text-align: left;">piano man</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.550</td>
<td style="text-align: right;">-6.483</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">177.734</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bob marley &amp; the wailers</td>
<td style="text-align: left;">could you be loved</td>
<td style="text-align: right;">0.916</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">-8.548</td>
<td style="text-align: right;">0.761</td>
<td style="text-align: right;">103.314</td>
</tr>
<tr class="even">
<td style="text-align: left;">bruce springsteen</td>
<td style="text-align: left;">dancing in the dark</td>
<td style="text-align: right;">0.527</td>
<td style="text-align: right;">0.942</td>
<td style="text-align: right;">-5.640</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">148.723</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="calculate-average-for-each-column-will-be-used-later-for-2023-and-2025-comparison" class="level4">
<h4 class="anchored" data-anchor-id="calculate-average-for-each-column-will-be-used-later-for-2023-and-2025-comparison">Calculate average for each column, will be used later for 2023 and 2025 comparison<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#calculate-average-for-each-column-will-be-used-later-for-2023-and-2025-comparison" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_spotify_25_avg <span class="kw">AS</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="fu">AVG</span>(danceability) <span class="kw">AS</span> danceability_avg,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(energy) <span class="kw">AS</span> energy_avg,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(loudness) <span class="kw">AS</span> loudness_avg,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(valence) <span class="kw">AS</span> valence_avg,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(tempo) <span class="kw">AS</span> tempo_avg,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2025</span> <span class="kw">AS</span> <span class="dt">year</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> new_zealand_25_matched_sql_cleaned </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_spotify_25_avg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: right;">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6224135</td>
<td style="text-align: right;">0.6279519</td>
<td style="text-align: right;">-7.118212</td>
<td style="text-align: right;">0.5429365</td>
<td style="text-align: right;">119.731</td>
<td style="text-align: right;">2025</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="south-korea-dataset-1" class="level2">
<h2 class="anchored" data-anchor-id="south-korea-dataset-1">South Korea Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#south-korea-dataset-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
</section>
<section id="korea-dataset" class="level2">
<h2 class="anchored" data-anchor-id="korea-dataset">Korea Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#korea-dataset" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<section id="join-korea-dataframe-and-updated-spotify-dataframe" class="level4">
<h4 class="anchored" data-anchor-id="join-korea-dataframe-and-updated-spotify-dataframe">Join Korea dataframe and updated Spotify dataframe<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#join-korea-dataframe-and-updated-spotify-dataframe" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="left-join-to-keep-all-the-rows-of-left-dataframe-1" class="level4">
<h4 class="anchored" data-anchor-id="left-join-to-keep-all-the-rows-of-left-dataframe-1">Left join to keep all the rows of left dataframe<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#left-join-to-keep-all-the-rows-of-left-dataframe-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_25_matched_sql <span class="kw">AS</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> k.<span class="op">*</span>, s.<span class="op">*</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> korea_25_clean <span class="kw">AS</span> k</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> spotify_2025_sql <span class="kw">AS</span> s</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> k.title <span class="op">=</span> s.title</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> k.artist <span class="op">=</span> s.artist;</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> korea_25_matched_sql</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> artist_1;</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> korea_25_matched_sql</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> title_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_25_matched_sql</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: left;">billie eilish</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="even">
<td style="text-align: left;">who</td>
<td style="text-align: left;">jimin</td>
<td style="text-align: right;">0.660</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">-3.743</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">116.034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">who</td>
<td style="text-align: left;">jimin</td>
<td style="text-align: right;">0.660</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">-3.743</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">116.034</td>
</tr>
<tr class="even">
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: left;">billie eilish</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">who</td>
<td style="text-align: left;">jimin</td>
<td style="text-align: right;">0.660</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">-3.743</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">116.034</td>
</tr>
<tr class="even">
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: left;">billie eilish</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: left;">billie eilish</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="even">
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: left;">billie eilish</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blue</td>
<td style="text-align: left;">yung kai</td>
<td style="text-align: right;">0.746</td>
<td style="text-align: right;">0.317</td>
<td style="text-align: right;">-11.982</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: right;">97.490</td>
</tr>
<tr class="even">
<td style="text-align: left;">double take</td>
<td style="text-align: left;">dhruv</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">-11.141</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">109.239</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="remove-duplicate" class="level4">
<h4 class="anchored" data-anchor-id="remove-duplicate">Remove duplicate<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-duplicate" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="drop-duplicate-rows-and-songs-with-no-analytic-data" class="level4">
<h4 class="anchored" data-anchor-id="drop-duplicate-rows-and-songs-with-no-analytic-data">Drop duplicate rows and songs with no analytic data<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#drop-duplicate-rows-and-songs-with-no-analytic-data" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_25_matched_sql_cleaned <span class="kw">AS</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="kw">ON</span> (artist, title) <span class="op">*</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> korea_25_matched_sql </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> danceability <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> artist, title</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_25_matched_sql_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 47%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">supernova</td>
<td style="text-align: left;">aespa</td>
<td style="text-align: right;">0.746</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">-4.283</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">120.070</td>
</tr>
<tr class="even">
<td style="text-align: left;">whiplash</td>
<td style="text-align: left;">aespa</td>
<td style="text-align: right;">0.856</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: right;">-2.954</td>
<td style="text-align: right;">0.743</td>
<td style="text-align: right;">126.007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">how can i love the heartbreak, you’re the one i love</td>
<td style="text-align: left;">akmu</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.248</td>
<td style="text-align: right;">-8.675</td>
<td style="text-align: right;">0.228</td>
<td style="text-align: right;">129.214</td>
</tr>
<tr class="even">
<td style="text-align: left;">birds of a feather</td>
<td style="text-align: left;">billie eilish</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">-10.171</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">104.978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">if i say, i love you</td>
<td style="text-align: left;">boynextdoor</td>
<td style="text-align: right;">0.675</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">-5.284</td>
<td style="text-align: right;">0.817</td>
<td style="text-align: right;">138.104</td>
</tr>
<tr class="even">
<td style="text-align: left;">a letter</td>
<td style="text-align: left;">bumjin</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">-7.256</td>
<td style="text-align: right;">0.178</td>
<td style="text-align: right;">145.937</td>
</tr>
<tr class="odd">
<td style="text-align: left;">closely far away</td>
<td style="text-align: left;">car</td>
<td style="text-align: right;">0.602</td>
<td style="text-align: right;">0.389</td>
<td style="text-align: right;">-7.099</td>
<td style="text-align: right;">0.169</td>
<td style="text-align: right;">93.037</td>
</tr>
<tr class="even">
<td style="text-align: left;">here with me</td>
<td style="text-align: left;">d4vd</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.450</td>
<td style="text-align: right;">-9.306</td>
<td style="text-align: right;">0.263</td>
<td style="text-align: right;">132.039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: left;">day6</td>
<td style="text-align: right;">0.535</td>
<td style="text-align: right;">0.963</td>
<td style="text-align: right;">-3.363</td>
<td style="text-align: right;">0.614</td>
<td style="text-align: right;">80.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">time of our life -japanese ver.- - japanese ver.</td>
<td style="text-align: left;">day6</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">0.977</td>
<td style="text-align: right;">-2.715</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">175.025</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_spotify_25_avg <span class="kw">AS</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span>  <span class="fu">AVG</span>(danceability) <span class="kw">AS</span> danceability_avg,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(energy) <span class="kw">AS</span> energy_avg,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(loudness) <span class="kw">AS</span> loudness_avg,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(valence) <span class="kw">AS</span> valence_avg,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(tempo) <span class="kw">AS</span> tempo_avg,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2025</span> <span class="kw">AS</span> <span class="dt">year</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> korea_25_matched_sql_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="usa-dataset-1" class="level3">
<h3 class="anchored" data-anchor-id="usa-dataset-1">USA Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#usa-dataset-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<section id="join-usa-dataframe-and-updated-spotify-dataframe" class="level4">
<h4 class="anchored" data-anchor-id="join-usa-dataframe-and-updated-spotify-dataframe">Join USA dataframe and updated Spotify dataframe<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#join-usa-dataframe-and-updated-spotify-dataframe" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="left-join-to-keep-all-the-rows-of-left-dataframe-2" class="level4">
<h4 class="anchored" data-anchor-id="left-join-to-keep-all-the-rows-of-left-dataframe-2">Left join to keep all the rows of left dataframe<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#left-join-to-keep-all-the-rows-of-left-dataframe-2" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_25_matched_sql <span class="kw">AS</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> u.<span class="op">*</span>, s.<span class="op">*</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> usa_25_clean <span class="kw">AS</span> u</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LEFT</span> <span class="kw">JOIN</span> spotify_2025_sql <span class="kw">AS</span> s</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> u.title <span class="op">=</span> s.title</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> u.artist <span class="op">=</span> s.artist;</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> usa_25_matched_sql</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> artist_1;</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> usa_25_matched_sql</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> title_1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_matched_sql_cleaned <span class="kw">AS</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="kw">ON</span> (artist, title) <span class="op">*</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> usa_25_matched_sql </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">WHERE</span> danceability <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> artist, title</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_matched_sql_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 40%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ordinary</td>
<td style="text-align: left;">alex warren</td>
<td style="text-align: right;">0.368</td>
<td style="text-align: right;">0.69400</td>
<td style="text-align: right;">-6.141</td>
<td style="text-align: right;">0.391</td>
<td style="text-align: right;">168.115</td>
</tr>
<tr class="even">
<td style="text-align: left;">505</td>
<td style="text-align: left;">arctic monkeys</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.86600</td>
<td style="text-align: right;">-5.822</td>
<td style="text-align: right;">0.248</td>
<td style="text-align: right;">140.266</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i wanna be yours</td>
<td style="text-align: left;">arctic monkeys</td>
<td style="text-align: right;">0.464</td>
<td style="text-align: right;">0.41700</td>
<td style="text-align: right;">-9.345</td>
<td style="text-align: right;">0.479</td>
<td style="text-align: right;">67.528</td>
</tr>
<tr class="even">
<td style="text-align: left;">we can’t be friends (wait for your love)</td>
<td style="text-align: left;">ariana grande</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.64600</td>
<td style="text-align: right;">-8.334</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">115.842</td>
</tr>
<tr class="odd">
<td style="text-align: left;">baile inolvidable</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">0.00332</td>
<td style="text-align: right;">-46.113</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">119.387</td>
</tr>
<tr class="even">
<td style="text-align: left;">dtmf</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.13100</td>
<td style="text-align: right;">-27.405</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">136.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">eoo</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.360</td>
<td style="text-align: right;">0.46400</td>
<td style="text-align: right;">-29.598</td>
<td style="text-align: right;">0.184</td>
<td style="text-align: right;">63.662</td>
</tr>
<tr class="even">
<td style="text-align: left;">nuevayol</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.19500</td>
<td style="text-align: right;">-20.024</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">137.922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beautiful things</td>
<td style="text-align: left;">benson boone</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.47100</td>
<td style="text-align: right;">-5.692</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">105.029</td>
</tr>
<tr class="even">
<td style="text-align: left;">mystical magical</td>
<td style="text-align: left;">benson boone</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.69700</td>
<td style="text-align: right;">-3.851</td>
<td style="text-align: right;">0.848</td>
<td style="text-align: right;">119.867</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_spotify_25_avg <span class="kw">AS</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="fu">AVG</span>(danceability) <span class="kw">AS</span> danceability_avg,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(energy) <span class="kw">AS</span> energy_avg,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(loudness) <span class="kw">AS</span> loudness_avg,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(valence) <span class="kw">AS</span> valence_avg,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">AVG</span>(tempo) <span class="kw">AS</span> tempo_avg,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2025</span> <span class="kw">AS</span> <span class="dt">year</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> usa_matched_sql_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_matched_sql_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 40%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ordinary</td>
<td style="text-align: left;">alex warren</td>
<td style="text-align: right;">0.368</td>
<td style="text-align: right;">0.69400</td>
<td style="text-align: right;">-6.141</td>
<td style="text-align: right;">0.391</td>
<td style="text-align: right;">168.115</td>
</tr>
<tr class="even">
<td style="text-align: left;">505</td>
<td style="text-align: left;">arctic monkeys</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.86600</td>
<td style="text-align: right;">-5.822</td>
<td style="text-align: right;">0.248</td>
<td style="text-align: right;">140.266</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i wanna be yours</td>
<td style="text-align: left;">arctic monkeys</td>
<td style="text-align: right;">0.464</td>
<td style="text-align: right;">0.41700</td>
<td style="text-align: right;">-9.345</td>
<td style="text-align: right;">0.479</td>
<td style="text-align: right;">67.528</td>
</tr>
<tr class="even">
<td style="text-align: left;">we can’t be friends (wait for your love)</td>
<td style="text-align: left;">ariana grande</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.64600</td>
<td style="text-align: right;">-8.334</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">115.842</td>
</tr>
<tr class="odd">
<td style="text-align: left;">baile inolvidable</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">0.00332</td>
<td style="text-align: right;">-46.113</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">119.387</td>
</tr>
<tr class="even">
<td style="text-align: left;">dtmf</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.13100</td>
<td style="text-align: right;">-27.405</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">136.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">eoo</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.360</td>
<td style="text-align: right;">0.46400</td>
<td style="text-align: right;">-29.598</td>
<td style="text-align: right;">0.184</td>
<td style="text-align: right;">63.662</td>
</tr>
<tr class="even">
<td style="text-align: left;">nuevayol</td>
<td style="text-align: left;">bad bunny</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.19500</td>
<td style="text-align: right;">-20.024</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">137.922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beautiful things</td>
<td style="text-align: left;">benson boone</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.47100</td>
<td style="text-align: right;">-5.692</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">105.029</td>
</tr>
<tr class="even">
<td style="text-align: left;">mystical magical</td>
<td style="text-align: left;">benson boone</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.69700</td>
<td style="text-align: right;">-3.851</td>
<td style="text-align: right;">0.848</td>
<td style="text-align: right;">119.867</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="correlation-studies" class="level2">
<h2 class="anchored" data-anchor-id="correlation-studies">Correlation Studies<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#correlation-studies" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h2>
<section id="combine-aggregated-spotify-dataset-with-happiness-report" class="level4">
<h4 class="anchored" data-anchor-id="combine-aggregated-spotify-dataset-with-happiness-report">Combine aggregated Spotify dataset with happiness report<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#combine-aggregated-spotify-dataset-with-happiness-report" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="drop-any-countries-with-no-happiness-score" class="level4">
<h4 class="anchored" data-anchor-id="drop-any-countries-with-no-happiness-score">Drop any countries with no happiness score<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#drop-any-countries-with-no-happiness-score" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> happiness_spotify_2023 <span class="kw">AS</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_global_2023_avg</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> happiness_report_23 </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> spotify_global_2023_avg.country <span class="op">=</span> happiness_report_23.country_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> happiness_spotify_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: left;">country_name</th>
<th style="text-align: right;">happiness_score</th>
<th style="text-align: right;">gdp_wellbeing</th>
<th style="text-align: right;">social_support</th>
<th style="text-align: right;">life_exp</th>
<th style="text-align: right;">freedom</th>
<th style="text-align: right;">generosity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Finland</td>
<td style="text-align: right;">0.7137897</td>
<td style="text-align: right;">0.6717491</td>
<td style="text-align: right;">-6.132559</td>
<td style="text-align: right;">0.5841033</td>
<td style="text-align: right;">117.5607</td>
<td style="text-align: left;">Finland</td>
<td style="text-align: right;">7.804</td>
<td style="text-align: right;">10.792</td>
<td style="text-align: right;">0.969</td>
<td style="text-align: right;">71.150</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: right;">-0.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">0.7082816</td>
<td style="text-align: right;">0.6586278</td>
<td style="text-align: right;">-6.340489</td>
<td style="text-align: right;">0.5821514</td>
<td style="text-align: right;">120.5634</td>
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">7.586</td>
<td style="text-align: right;">10.962</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">71.250</td>
<td style="text-align: right;">0.934</td>
<td style="text-align: right;">0.134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iceland</td>
<td style="text-align: right;">0.6764232</td>
<td style="text-align: right;">0.4807473</td>
<td style="text-align: right;">-9.070748</td>
<td style="text-align: right;">0.5048626</td>
<td style="text-align: right;">120.2250</td>
<td style="text-align: left;">Iceland</td>
<td style="text-align: right;">7.530</td>
<td style="text-align: right;">10.896</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: right;">72.050</td>
<td style="text-align: right;">0.936</td>
<td style="text-align: right;">0.211</td>
</tr>
<tr class="even">
<td style="text-align: left;">Israel</td>
<td style="text-align: right;">0.5880993</td>
<td style="text-align: right;">0.5171235</td>
<td style="text-align: right;">-8.436637</td>
<td style="text-align: right;">0.4254157</td>
<td style="text-align: right;">121.3037</td>
<td style="text-align: left;">Israel</td>
<td style="text-align: right;">7.473</td>
<td style="text-align: right;">10.639</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">72.697</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-0.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">0.6521375</td>
<td style="text-align: right;">0.6765582</td>
<td style="text-align: right;">-6.545548</td>
<td style="text-align: right;">0.5170867</td>
<td style="text-align: right;">126.5997</td>
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">7.403</td>
<td style="text-align: right;">10.942</td>
<td style="text-align: right;">0.930</td>
<td style="text-align: right;">71.550</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.213</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweden</td>
<td style="text-align: right;">0.6199036</td>
<td style="text-align: right;">0.5375296</td>
<td style="text-align: right;">-8.296959</td>
<td style="text-align: right;">0.4740495</td>
<td style="text-align: right;">123.0130</td>
<td style="text-align: left;">Sweden</td>
<td style="text-align: right;">7.395</td>
<td style="text-align: right;">10.883</td>
<td style="text-align: right;">0.939</td>
<td style="text-align: right;">72.150</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">0.6195445</td>
<td style="text-align: right;">0.5927185</td>
<td style="text-align: right;">-7.459607</td>
<td style="text-align: right;">0.4707596</td>
<td style="text-align: right;">123.9822</td>
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">7.315</td>
<td style="text-align: right;">11.088</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">71.500</td>
<td style="text-align: right;">0.947</td>
<td style="text-align: right;">0.141</td>
</tr>
<tr class="even">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">0.6642215</td>
<td style="text-align: right;">0.6401841</td>
<td style="text-align: right;">-6.634767</td>
<td style="text-align: right;">0.4908706</td>
<td style="text-align: right;">122.0180</td>
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">7.240</td>
<td style="text-align: right;">11.164</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">72.900</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: right;">0.6730043</td>
<td style="text-align: right;">0.6595218</td>
<td style="text-align: right;">-6.393453</td>
<td style="text-align: right;">0.5104961</td>
<td style="text-align: right;">125.4097</td>
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: right;">7.228</td>
<td style="text-align: right;">11.660</td>
<td style="text-align: right;">0.879</td>
<td style="text-align: right;">71.675</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">0.024</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">0.6577795</td>
<td style="text-align: right;">0.6345049</td>
<td style="text-align: right;">-6.839719</td>
<td style="text-align: right;">0.5207364</td>
<td style="text-align: right;">122.8093</td>
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">7.123</td>
<td style="text-align: right;">10.662</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">70.350</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.175</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="remove-country-column-for-correlation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="remove-country-column-for-correlation-analysis">Remove Country column for correlation analysis<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-country-column-for-correlation-analysis" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="create-melted-matrix" class="level3">
<h3 class="anchored" data-anchor-id="create-melted-matrix">Create melted matrix<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#create-melted-matrix" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> melted_matrix <span class="kw">AS</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cols <span class="kw">AS</span> (</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> (<span class="kw">VALUES</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'danceability_avg'</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'energy_avg'</span>),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'loudness_avg'</span>),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'valence_avg'</span>),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'tempo_avg'</span>),</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'happiness_score'</span>),</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'gdp_wellbeing'</span>),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'social_support'</span>),</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'life_exp'</span>),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'freedom'</span>),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'generosity'</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">AS</span> t(col)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>pairs <span class="kw">AS</span> (</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> c1.col <span class="kw">AS</span> var1, c2.col <span class="kw">AS</span> var2</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cols c1 <span class="kw">CROSS</span> <span class="kw">JOIN</span> cols c2</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>    var1,</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>    var2,</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> <span class="fu">covar_samp</span>(</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> var1</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'danceability_avg'</span> <span class="cf">THEN</span> danceability_avg</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'energy_avg'</span> <span class="cf">THEN</span> energy_avg</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'loudness_avg'</span> <span class="cf">THEN</span> loudness_avg</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'valence_avg'</span> <span class="cf">THEN</span> valence_avg</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'tempo_avg'</span> <span class="cf">THEN</span> tempo_avg</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'happiness_score'</span> <span class="cf">THEN</span> happiness_score</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'gdp_wellbeing'</span> <span class="cf">THEN</span> gdp_wellbeing</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'social_support'</span> <span class="cf">THEN</span> social_support</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'life_exp'</span> <span class="cf">THEN</span> life_exp</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'freedom'</span> <span class="cf">THEN</span> freedom</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'generosity'</span> <span class="cf">THEN</span> generosity</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> var2</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'danceability_avg'</span> <span class="cf">THEN</span> danceability_avg</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'energy_avg'</span> <span class="cf">THEN</span> energy_avg</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'loudness_avg'</span> <span class="cf">THEN</span> loudness_avg</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'valence_avg'</span> <span class="cf">THEN</span> valence_avg</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'tempo_avg'</span> <span class="cf">THEN</span> tempo_avg</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'happiness_score'</span> <span class="cf">THEN</span> happiness_score</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'gdp_wellbeing'</span> <span class="cf">THEN</span> gdp_wellbeing</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'social_support'</span> <span class="cf">THEN</span> social_support</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'life_exp'</span> <span class="cf">THEN</span> life_exp</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'freedom'</span> <span class="cf">THEN</span> freedom</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'generosity'</span> <span class="cf">THEN</span> generosity</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> happiness_spotify_2023</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span></span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">SELECT</span> <span class="fu">stddev_samp</span>(</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> var1</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'danceability_avg'</span> <span class="cf">THEN</span> danceability_avg</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'energy_avg'</span> <span class="cf">THEN</span> energy_avg</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'loudness_avg'</span> <span class="cf">THEN</span> loudness_avg</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'valence_avg'</span> <span class="cf">THEN</span> valence_avg</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'tempo_avg'</span> <span class="cf">THEN</span> tempo_avg</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'happiness_score'</span> <span class="cf">THEN</span> happiness_score</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'gdp_wellbeing'</span> <span class="cf">THEN</span> gdp_wellbeing</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'social_support'</span> <span class="cf">THEN</span> social_support</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'life_exp'</span> <span class="cf">THEN</span> life_exp</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'freedom'</span> <span class="cf">THEN</span> freedom</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'generosity'</span> <span class="cf">THEN</span> generosity</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">FROM</span> happiness_spotify_2023)</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span></span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">SELECT</span> <span class="fu">stddev_samp</span>(</span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> var2</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'danceability_avg'</span> <span class="cf">THEN</span> danceability_avg</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'energy_avg'</span> <span class="cf">THEN</span> energy_avg</span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'loudness_avg'</span> <span class="cf">THEN</span> loudness_avg</span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'valence_avg'</span> <span class="cf">THEN</span> valence_avg</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'tempo_avg'</span> <span class="cf">THEN</span> tempo_avg</span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'happiness_score'</span> <span class="cf">THEN</span> happiness_score</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'gdp_wellbeing'</span> <span class="cf">THEN</span> gdp_wellbeing</span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'social_support'</span> <span class="cf">THEN</span> social_support</span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'life_exp'</span> <span class="cf">THEN</span> life_exp</span>
<span id="cb72-84"><a href="#cb72-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'freedom'</span> <span class="cf">THEN</span> freedom</span>
<span id="cb72-85"><a href="#cb72-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'generosity'</span> <span class="cf">THEN</span> generosity</span>
<span id="cb72-86"><a href="#cb72-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb72-87"><a href="#cb72-87" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">FROM</span> happiness_spotify_2023)</span>
<span id="cb72-88"><a href="#cb72-88" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">AS</span> <span class="fu">corr</span></span>
<span id="cb72-89"><a href="#cb72-89" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> pairs</span>
<span id="cb72-90"><a href="#cb72-90" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span></span>
<span id="cb72-91"><a href="#cb72-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> var1</span>
<span id="cb72-92"><a href="#cb72-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'danceability_avg'</span> <span class="cf">THEN</span> <span class="dv">1</span></span>
<span id="cb72-93"><a href="#cb72-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'energy_avg'</span> <span class="cf">THEN</span> <span class="dv">2</span></span>
<span id="cb72-94"><a href="#cb72-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'loudness_avg'</span> <span class="cf">THEN</span> <span class="dv">3</span></span>
<span id="cb72-95"><a href="#cb72-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'valence_avg'</span> <span class="cf">THEN</span> <span class="dv">4</span></span>
<span id="cb72-96"><a href="#cb72-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'tempo_avg'</span> <span class="cf">THEN</span> <span class="dv">5</span></span>
<span id="cb72-97"><a href="#cb72-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'happiness_score'</span> <span class="cf">THEN</span> <span class="dv">6</span></span>
<span id="cb72-98"><a href="#cb72-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'gdp_wellbeing'</span> <span class="cf">THEN</span> <span class="dv">7</span></span>
<span id="cb72-99"><a href="#cb72-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'social_support'</span> <span class="cf">THEN</span> <span class="dv">8</span></span>
<span id="cb72-100"><a href="#cb72-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'life_exp'</span> <span class="cf">THEN</span> <span class="dv">9</span></span>
<span id="cb72-101"><a href="#cb72-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'freedom'</span> <span class="cf">THEN</span> <span class="dv">10</span></span>
<span id="cb72-102"><a href="#cb72-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'generosity'</span> <span class="cf">THEN</span> <span class="dv">11</span></span>
<span id="cb72-103"><a href="#cb72-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb72-104"><a href="#cb72-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> var2</span>
<span id="cb72-105"><a href="#cb72-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'danceability_avg'</span> <span class="cf">THEN</span> <span class="dv">1</span></span>
<span id="cb72-106"><a href="#cb72-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'energy_avg'</span> <span class="cf">THEN</span> <span class="dv">2</span></span>
<span id="cb72-107"><a href="#cb72-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'loudness_avg'</span> <span class="cf">THEN</span> <span class="dv">3</span></span>
<span id="cb72-108"><a href="#cb72-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'valence_avg'</span> <span class="cf">THEN</span> <span class="dv">4</span></span>
<span id="cb72-109"><a href="#cb72-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'tempo_avg'</span> <span class="cf">THEN</span> <span class="dv">5</span></span>
<span id="cb72-110"><a href="#cb72-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'happiness_score'</span> <span class="cf">THEN</span> <span class="dv">6</span></span>
<span id="cb72-111"><a href="#cb72-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'gdp_wellbeing'</span> <span class="cf">THEN</span> <span class="dv">7</span></span>
<span id="cb72-112"><a href="#cb72-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'social_support'</span> <span class="cf">THEN</span> <span class="dv">8</span></span>
<span id="cb72-113"><a href="#cb72-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'life_exp'</span> <span class="cf">THEN</span> <span class="dv">9</span></span>
<span id="cb72-114"><a href="#cb72-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'freedom'</span> <span class="cf">THEN</span> <span class="dv">10</span></span>
<span id="cb72-115"><a href="#cb72-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'generosity'</span> <span class="cf">THEN</span> <span class="dv">11</span></span>
<span id="cb72-116"><a href="#cb72-116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> melted_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">var1</th>
<th style="text-align: left;">var2</th>
<th style="text-align: right;">corr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.4647938</td>
</tr>
<tr class="odd">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">0.4260487</td>
</tr>
<tr class="even">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.6118727</td>
</tr>
<tr class="odd">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">-0.1665718</td>
</tr>
<tr class="even">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">happiness_score</td>
<td style="text-align: right;">-0.3109281</td>
</tr>
<tr class="odd">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">gdp_wellbeing</td>
<td style="text-align: right;">-0.4552611</td>
</tr>
<tr class="even">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">social_support</td>
<td style="text-align: right;">-0.1886128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">life_exp</td>
<td style="text-align: right;">-0.2807188</td>
</tr>
<tr class="even">
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: left;">freedom</td>
<td style="text-align: right;">-0.2969592</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analyzing-correlations-in-the-top-10-happiness-score-countries" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-correlations-in-the-top-10-happiness-score-countries">Analyzing Correlations in the Top 10 Happiness Score Countries<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#analyzing-correlations-in-the-top-10-happiness-score-countries" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> top_happiness_score_spotify_23 <span class="kw">AS</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> happiness_spotify_2023</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> happiness_score <span class="kw">DESC</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">LIMIT</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="remove-country-column-for-correlation-study" class="level4">
<h4 class="anchored" data-anchor-id="remove-country-column-for-correlation-study">Remove Country column for correlation study<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-country-column-for-correlation-study" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> top_happiness_score_spotify_23</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> Country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> top_happiness_score_spotify_23</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: left;">country_name</th>
<th style="text-align: right;">happiness_score</th>
<th style="text-align: right;">gdp_wellbeing</th>
<th style="text-align: right;">social_support</th>
<th style="text-align: right;">life_exp</th>
<th style="text-align: right;">freedom</th>
<th style="text-align: right;">generosity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.7137897</td>
<td style="text-align: right;">0.6717491</td>
<td style="text-align: right;">-6.132559</td>
<td style="text-align: right;">0.5841033</td>
<td style="text-align: right;">117.5607</td>
<td style="text-align: left;">Finland</td>
<td style="text-align: right;">7.804</td>
<td style="text-align: right;">10.792</td>
<td style="text-align: right;">0.969</td>
<td style="text-align: right;">71.150</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: right;">-0.019</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7082816</td>
<td style="text-align: right;">0.6586278</td>
<td style="text-align: right;">-6.340489</td>
<td style="text-align: right;">0.5821514</td>
<td style="text-align: right;">120.5634</td>
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">7.586</td>
<td style="text-align: right;">10.962</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">71.250</td>
<td style="text-align: right;">0.934</td>
<td style="text-align: right;">0.134</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6764232</td>
<td style="text-align: right;">0.4807473</td>
<td style="text-align: right;">-9.070748</td>
<td style="text-align: right;">0.5048626</td>
<td style="text-align: right;">120.2250</td>
<td style="text-align: left;">Iceland</td>
<td style="text-align: right;">7.530</td>
<td style="text-align: right;">10.896</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: right;">72.050</td>
<td style="text-align: right;">0.936</td>
<td style="text-align: right;">0.211</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5880993</td>
<td style="text-align: right;">0.5171235</td>
<td style="text-align: right;">-8.436637</td>
<td style="text-align: right;">0.4254157</td>
<td style="text-align: right;">121.3037</td>
<td style="text-align: left;">Israel</td>
<td style="text-align: right;">7.473</td>
<td style="text-align: right;">10.639</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">72.697</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-0.023</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6521375</td>
<td style="text-align: right;">0.6765582</td>
<td style="text-align: right;">-6.545548</td>
<td style="text-align: right;">0.5170867</td>
<td style="text-align: right;">126.5997</td>
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">7.403</td>
<td style="text-align: right;">10.942</td>
<td style="text-align: right;">0.930</td>
<td style="text-align: right;">71.550</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.213</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6199036</td>
<td style="text-align: right;">0.5375296</td>
<td style="text-align: right;">-8.296959</td>
<td style="text-align: right;">0.4740495</td>
<td style="text-align: right;">123.0130</td>
<td style="text-align: left;">Sweden</td>
<td style="text-align: right;">7.395</td>
<td style="text-align: right;">10.883</td>
<td style="text-align: right;">0.939</td>
<td style="text-align: right;">72.150</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.165</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6195445</td>
<td style="text-align: right;">0.5927185</td>
<td style="text-align: right;">-7.459607</td>
<td style="text-align: right;">0.4707596</td>
<td style="text-align: right;">123.9822</td>
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">7.315</td>
<td style="text-align: right;">11.088</td>
<td style="text-align: right;">0.943</td>
<td style="text-align: right;">71.500</td>
<td style="text-align: right;">0.947</td>
<td style="text-align: right;">0.141</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6642215</td>
<td style="text-align: right;">0.6401841</td>
<td style="text-align: right;">-6.634767</td>
<td style="text-align: right;">0.4908706</td>
<td style="text-align: right;">122.0180</td>
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">7.240</td>
<td style="text-align: right;">11.164</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">72.900</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6730043</td>
<td style="text-align: right;">0.6595218</td>
<td style="text-align: right;">-6.393453</td>
<td style="text-align: right;">0.5104961</td>
<td style="text-align: right;">125.4097</td>
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: right;">7.228</td>
<td style="text-align: right;">11.660</td>
<td style="text-align: right;">0.879</td>
<td style="text-align: right;">71.675</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">0.024</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6577795</td>
<td style="text-align: right;">0.6345049</td>
<td style="text-align: right;">-6.839719</td>
<td style="text-align: right;">0.5207364</td>
<td style="text-align: right;">122.8093</td>
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">7.123</td>
<td style="text-align: right;">10.662</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">70.350</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.175</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analyzing-correlations-in-the-bottom-10-happiness-score-countries" class="level4">
<h4 class="anchored" data-anchor-id="analyzing-correlations-in-the-bottom-10-happiness-score-countries">Analyzing Correlations in the Bottom 10 Happiness Score Countries<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#analyzing-correlations-in-the-bottom-10-happiness-score-countries" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> bottom_happiness_score_spotify_23 <span class="kw">AS</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">FROM</span> happiness_spotify_2023</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">ORDER</span> <span class="kw">BY</span> happiness_score</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">LIMIT</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-country-column-for-correlation-study-1" class="level4">
<h4 class="anchored" data-anchor-id="remove-country-column-for-correlation-study-1">Remove Country column for correlation study<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#remove-country-column-for-correlation-study-1" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> bottom_happiness_score_spotify_23</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> bottom_happiness_score_spotify_23</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: left;">country_name</th>
<th style="text-align: right;">happiness_score</th>
<th style="text-align: right;">gdp_wellbeing</th>
<th style="text-align: right;">social_support</th>
<th style="text-align: right;">life_exp</th>
<th style="text-align: right;">freedom</th>
<th style="text-align: right;">generosity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6733180</td>
<td style="text-align: right;">0.6203325</td>
<td style="text-align: right;">-7.006064</td>
<td style="text-align: right;">0.5268104</td>
<td style="text-align: right;">106.0316</td>
<td style="text-align: left;">India</td>
<td style="text-align: right;">4.036</td>
<td style="text-align: right;">8.759</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">60.777</td>
<td style="text-align: right;">0.897</td>
<td style="text-align: right;">0.072</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7023652</td>
<td style="text-align: right;">0.6684440</td>
<td style="text-align: right;">-6.467412</td>
<td style="text-align: right;">0.6249061</td>
<td style="text-align: right;">119.9778</td>
<td style="text-align: left;">Egypt</td>
<td style="text-align: right;">4.170</td>
<td style="text-align: right;">9.367</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">63.503</td>
<td style="text-align: right;">0.732</td>
<td style="text-align: right;">-0.183</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7183466</td>
<td style="text-align: right;">0.5870974</td>
<td style="text-align: right;">-7.686563</td>
<td style="text-align: right;">0.5517563</td>
<td style="text-align: right;">108.6704</td>
<td style="text-align: left;">Pakistan</td>
<td style="text-align: right;">4.555</td>
<td style="text-align: right;">8.540</td>
<td style="text-align: right;">0.601</td>
<td style="text-align: right;">57.313</td>
<td style="text-align: right;">0.766</td>
<td style="text-align: right;">0.008</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7007875</td>
<td style="text-align: right;">0.6192343</td>
<td style="text-align: right;">-7.871914</td>
<td style="text-align: right;">0.5560485</td>
<td style="text-align: right;">117.6424</td>
<td style="text-align: left;">Morocco</td>
<td style="text-align: right;">4.903</td>
<td style="text-align: right;">8.973</td>
<td style="text-align: right;">0.553</td>
<td style="text-align: right;">63.901</td>
<td style="text-align: right;">0.787</td>
<td style="text-align: right;">-0.231</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7727367</td>
<td style="text-align: right;">0.6885811</td>
<td style="text-align: right;">-7.111723</td>
<td style="text-align: right;">0.6297152</td>
<td style="text-align: right;">117.7797</td>
<td style="text-align: left;">Nigeria</td>
<td style="text-align: right;">4.981</td>
<td style="text-align: right;">8.496</td>
<td style="text-align: right;">0.740</td>
<td style="text-align: right;">54.891</td>
<td style="text-align: right;">0.718</td>
<td style="text-align: right;">0.073</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7204191</td>
<td style="text-align: right;">0.6520376</td>
<td style="text-align: right;">-7.023956</td>
<td style="text-align: right;">0.5060330</td>
<td style="text-align: right;">121.0217</td>
<td style="text-align: left;">Ukraine</td>
<td style="text-align: right;">5.071</td>
<td style="text-align: right;">9.314</td>
<td style="text-align: right;">0.878</td>
<td style="text-align: right;">64.550</td>
<td style="text-align: right;">0.795</td>
<td style="text-align: right;">0.240</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7662228</td>
<td style="text-align: right;">0.6797107</td>
<td style="text-align: right;">-5.443992</td>
<td style="text-align: right;">0.5326752</td>
<td style="text-align: right;">122.7244</td>
<td style="text-align: left;">Venezuela</td>
<td style="text-align: right;">5.211</td>
<td style="text-align: right;">5.527</td>
<td style="text-align: right;">0.839</td>
<td style="text-align: right;">64.050</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">0.128</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7264542</td>
<td style="text-align: right;">0.5796442</td>
<td style="text-align: right;">-9.766683</td>
<td style="text-align: right;">0.4776479</td>
<td style="text-align: right;">116.6581</td>
<td style="text-align: left;">South Africa</td>
<td style="text-align: right;">5.275</td>
<td style="text-align: right;">9.478</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">56.989</td>
<td style="text-align: right;">0.730</td>
<td style="text-align: right;">-0.087</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5319818</td>
<td style="text-align: right;">0.5319921</td>
<td style="text-align: right;">-7.866876</td>
<td style="text-align: right;">0.4064228</td>
<td style="text-align: right;">118.9620</td>
<td style="text-align: left;">Indonesia</td>
<td style="text-align: right;">5.277</td>
<td style="text-align: right;">9.385</td>
<td style="text-align: right;">0.804</td>
<td style="text-align: right;">63.048</td>
<td style="text-align: right;">0.880</td>
<td style="text-align: right;">0.531</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7098246</td>
<td style="text-align: right;">0.7643794</td>
<td style="text-align: right;">-5.443737</td>
<td style="text-align: right;">0.6130492</td>
<td style="text-align: right;">132.6508</td>
<td style="text-align: left;">Bulgaria</td>
<td style="text-align: right;">5.466</td>
<td style="text-align: right;">10.087</td>
<td style="text-align: right;">0.918</td>
<td style="text-align: right;">66.500</td>
<td style="text-align: right;">0.801</td>
<td style="text-align: right;">-0.057</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="since-2025-happiness-report-is-not-available-yet-we-will-compare-the-average-of-music-analytic-components-and-note-if-there-are-any-changes." class="level4">
<h4 class="anchored" data-anchor-id="since-2025-happiness-report-is-not-available-yet-we-will-compare-the-average-of-music-analytic-components-and-note-if-there-are-any-changes.">Since
 2025 Happiness Report is not available yet, we will compare the average
 of music analytic components and note if there are any changes.<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#since-2025-happiness-report-is-not-available-yet-we-will-compare-the-average-of-music-analytic-components-and-note-if-there-are-any-changes." style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
</section>
<section id="new-zealand" class="level4">
<h4 class="anchored" data-anchor-id="new-zealand">New Zealand<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#new-zealand" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_2023 <span class="kw">AS</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span>,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2023</span> <span class="kw">AS</span> <span class="dt">year</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_global_2023_avg</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> country <span class="kw">IN</span> (<span class="st">'New Zealand'</span>);</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> new_zealand_2023</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: right;">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6577795</td>
<td style="text-align: right;">0.6345049</td>
<td style="text-align: right;">-6.839719</td>
<td style="text-align: right;">0.5207364</td>
<td style="text-align: right;">122.8093</td>
<td style="text-align: right;">2023</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_spotify_combined <span class="kw">AS</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> new_zealand_2023</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> new_zealand_spotify_25_avg;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_spotify_combined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: right;">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6577795</td>
<td style="text-align: right;">0.6345049</td>
<td style="text-align: right;">-6.839719</td>
<td style="text-align: right;">0.5207364</td>
<td style="text-align: right;">122.8093</td>
<td style="text-align: right;">2023</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6224135</td>
<td style="text-align: right;">0.6279519</td>
<td style="text-align: right;">-7.118212</td>
<td style="text-align: right;">0.5429365</td>
<td style="text-align: right;">119.7310</td>
<td style="text-align: right;">2025</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="melt-combined-nz-table" class="level4">
<h4 class="anchored" data-anchor-id="melt-combined-nz-table">Melt combined NZ table<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#melt-combined-nz-table" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> new_zealand_spotify_combined_melt <span class="kw">AS</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_spotify_combined</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>UNPIVOT (</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value</span> <span class="cf">FOR</span> variable <span class="kw">IN</span> (</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        danceability_avg,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        energy_avg,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>        loudness_avg,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        valence_avg,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>        tempo_avg</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> new_zealand_spotify_combined_melt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">variable</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">0.6577795</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.6345049</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">-6.8397190</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.5207364</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">122.8093265</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">0.6224135</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.6279519</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">-7.1182115</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.5429365</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">119.7309712</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="south-korea" class="level3">
<h3 class="anchored" data-anchor-id="south-korea">South Korea<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#south-korea" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_2023 <span class="kw">AS</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2023</span> <span class="kw">AS</span> <span class="dt">year</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_global_2023_avg</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> country <span class="kw">IN</span> (<span class="st">'South Korea'</span>);</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> korea_2023</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_spotify_combined <span class="kw">AS</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> korea_2023</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> korea_spotify_25_avg;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_spotify_combined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: right;">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6394398</td>
<td style="text-align: right;">0.6369704</td>
<td style="text-align: right;">-5.835685</td>
<td style="text-align: right;">0.4896630</td>
<td style="text-align: right;">115.5439</td>
<td style="text-align: right;">2023</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6368143</td>
<td style="text-align: right;">0.6823857</td>
<td style="text-align: right;">-5.376986</td>
<td style="text-align: right;">0.5210971</td>
<td style="text-align: right;">126.6208</td>
<td style="text-align: right;">2025</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> korea_spotify_combined_melt <span class="kw">AS</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_spotify_combined</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>UNPIVOT (</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value</span> <span class="cf">FOR</span> variable <span class="kw">IN</span> (</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>        danceability_avg,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>        energy_avg,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>        loudness_avg,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>        valence_avg,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>        tempo_avg</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> korea_spotify_combined_melt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">variable</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">0.6394398</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.6369704</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">-5.8356848</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.4896630</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">115.5438857</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">0.6368143</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.6823857</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">-5.3769857</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.5210971</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">126.6207714</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="usa" class="level3">
<h3 class="anchored" data-anchor-id="usa">USA<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#usa" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_2023 <span class="kw">AS</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="op">*</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2023</span> <span class="kw">AS</span> <span class="dt">year</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> spotify_global_2023_avg</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> country <span class="kw">IN</span> (<span class="st">'United States'</span>);</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> usa_2023</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">COLUMN</span> country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: right;">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6415203</td>
<td style="text-align: right;">0.6265478</td>
<td style="text-align: right;">-6.91622</td>
<td style="text-align: right;">0.4509318</td>
<td style="text-align: right;">125.3751</td>
<td style="text-align: right;">2023</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_spotify_combined <span class="kw">AS</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> usa_2023</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> usa_spotify_25_avg;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_spotify_combined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">danceability_avg</th>
<th style="text-align: right;">energy_avg</th>
<th style="text-align: right;">loudness_avg</th>
<th style="text-align: right;">valence_avg</th>
<th style="text-align: right;">tempo_avg</th>
<th style="text-align: right;">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.6415203</td>
<td style="text-align: right;">0.6265478</td>
<td style="text-align: right;">-6.916220</td>
<td style="text-align: right;">0.4509318</td>
<td style="text-align: right;">125.3751</td>
<td style="text-align: right;">2023</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5896566</td>
<td style="text-align: right;">0.6021345</td>
<td style="text-align: right;">-7.953424</td>
<td style="text-align: right;">0.4809919</td>
<td style="text-align: right;">120.2606</td>
<td style="text-align: right;">2025</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> usa_spotify_combined_melt <span class="kw">AS</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_spotify_combined</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>UNPIVOT (</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value</span> <span class="cf">FOR</span> variable <span class="kw">IN</span> (</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>        danceability_avg,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>        energy_avg,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>        loudness_avg,</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>        valence_avg,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>        tempo_avg</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> usa_spotify_combined_melt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">variable</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">0.6415203</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.6265478</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">-6.9162202</td>
</tr>
<tr class="even">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.4509318</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2023</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">125.3750667</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">danceability_avg</td>
<td style="text-align: right;">0.5896566</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">energy_avg</td>
<td style="text-align: right;">0.6021345</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">loudness_avg</td>
<td style="text-align: right;">-7.9534242</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">valence_avg</td>
<td style="text-align: right;">0.4809919</td>
</tr>
<tr class="even">
<td style="text-align: right;">2025</td>
<td style="text-align: left;">tempo_avg</td>
<td style="text-align: right;">120.2606364</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->





<script>
  window.backupDefine = window.define;
  window.define = undefined;
</script>
<script type="text/javascript" src="FINAL%20data%20wrangling%20Final%20Project%20SQL_files/quarto-preview.js"></script>
<script>
  window.define = window.backupDefine;
  window.backupDefine = undefined;
</script>
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    window.QuartoPreview.init({
      origin: "",
      search: "",
      inputFile: "C:\Users\User\Documents\Project Files\Data Wrangling Final Project - SQL version.qmd",
      isPresentation: false
    });
  })
</script>
<div><div dir="ltr" class="fui-FluentProvider fui-FluentProviderr0 ___jdtuxv0 f19n0e5 fxugw4r f1o700av fk6fouc fkhj508 figsok6 f1i3iumi"></div></div><i tabindex="0" role="none" data-tabster-dummy="" aria-hidden="true" style="position: fixed; height: 1px; width: 1px; opacity: 0.001; z-index: -1; content-visibility: hidden; top: 0px; left: 0px;"></i></body></html>