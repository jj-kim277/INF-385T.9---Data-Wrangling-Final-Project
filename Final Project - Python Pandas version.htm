<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/clipboard/clipboard.min.js"></script>
<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/popper.min.js"></script>
<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/anchor.min.js"></script>
<link href="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Data Wrangling Final Project - Python Pandas ver 3 copy_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Project</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="python-pandas" class="level1">
<h1>Python Pandas</h1>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">RETICULATE_PYTHON =</span> <span class="st">"C:/Users/User/AppData/Local/Programs/Python/Python313/python.exe"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>python:         C:/Users/User/AppData/Local/Programs/Python/Python313/python.exe
libpython:      C:/Users/User/AppData/Local/Programs/Python/Python313/python313.dll
pythonhome:     C:/Users/User/AppData/Local/Programs/Python/Python313
version:        3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:09:13) [MSC v.1944 64 bit (AMD64)]
Architecture:   64bit
numpy:          C:/Users/User/AppData/Local/Programs/Python/Python313/Lib/site-packages/numpy
numpy_version:  2.3.5

NOTE: Python version was forced by RETICULATE_PYTHON</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"C:/Users/User/AppData/Local/Programs/Python/Python313/python.exe"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">py_config</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>python:         C:/Users/User/AppData/Local/Programs/Python/Python313/python.exe
libpython:      C:/Users/User/AppData/Local/Programs/Python/Python313/python313.dll
pythonhome:     C:/Users/User/AppData/Local/Programs/Python/Python313
version:        3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:09:13) [MSC v.1944 64 bit (AMD64)]
Architecture:   64bit
numpy:          C:/Users/User/AppData/Local/Programs/Python/Python313/Lib/site-packages/numpy
numpy_version:  2.3.5

NOTE: Python version was forced by RETICULATE_PYTHON</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-dataset-1---world-happiness-report" class="level2">
<h2 class="anchored" data-anchor-id="import-dataset-1---world-happiness-report">Import Dataset 1 - World Happiness Report</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Load World Happiness Report - 2023</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>WHR23 <span class="op">=</span> pd.read_csv(<span class="st">'whr.csv'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Show all columns of WHR23 </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(WHR23.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Country name', 'Ladder score', 'Standard error of ladder score',
       'upperwhisker', 'lowerwhisker', 'Logged GDP per capita',
       'Social support', 'Healthy life expectancy',
       'Freedom to make life choices', 'Generosity',
       'Perceptions of corruption', 'Ladder score in Dystopia',
       'Explained by: Log GDP per capita', 'Explained by: Social support',
       'Explained by: Healthy life expectancy',
       'Explained by: Freedom to make life choices',
       'Explained by: Generosity', 'Explained by: Perceptions of corruption',
       'Dystopia + residual'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Select Country.name,Ladder.score,Logged.GDP.per.capita, Social.support,Healthy.life.expectancy</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Freedom.to.make.life.choices,Generosity</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>WHR23 <span class="op">=</span> WHR23.<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'Country name'</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Ladder score'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Logged GDP per capita'</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Social support'</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Healthy life expectancy'</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Freedom to make life choices'</span>, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Generosity'</span>])</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(WHR23.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Country name', 'Ladder score', 'Logged GDP per capita',
       'Social support', 'Healthy life expectancy',
       'Freedom to make life choices', 'Generosity'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Rename columns to replace spaces with underscore</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">## and a new name for more intuitive understanding</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Happiness_report_23 <span class="op">=</span> WHR23.rename(columns <span class="op">=</span> {<span class="st">'Country name'</span>: <span class="st">'country_name'</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Ladder score'</span>: <span class="st">'happiness_score'</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Logged GDP per capita'</span>: <span class="st">'gdp_wellbeing'</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Social support'</span>: <span class="st">'social_support'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Healthy life expectancy'</span>: <span class="st">'life_exp'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Freedom to make life choices'</span>: <span class="st">'freedom'</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Generosity'</span>: <span class="st">'generosity'</span>})</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                                              </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Happiness_report_23)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         country_name  happiness_score  ...  freedom  generosity
0             Finland            7.804  ...    0.961      -0.019
1             Denmark            7.586  ...    0.934       0.134
2             Iceland            7.530  ...    0.936       0.211
3              Israel            7.473  ...    0.809      -0.023
4         Netherlands            7.403  ...    0.887       0.213
..                ...              ...  ...      ...         ...
132  Congo (Kinshasa)            3.207  ...    0.664       0.086
133          Zimbabwe            3.204  ...    0.654      -0.046
134      Sierra Leone            3.138  ...    0.660       0.105
135           Lebanon            2.392  ...    0.474      -0.141
136       Afghanistan            1.859  ...    0.382      -0.081

[137 rows x 7 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Happiness_report_23.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['country_name', 'happiness_score', 'gdp_wellbeing', 'social_support',
       'life_exp', 'freedom', 'generosity'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="import-dataset-2" class="level2">
<h2 class="anchored" data-anchor-id="import-dataset-2">Import Dataset 2</h2>
<p><a href="https://www.geeksforgeeks.org/python/python-remove-spaces-from-a-string/" class="uri">https://www.geeksforgeeks.org/python/python-remove-spaces-from-a-string/</a></p>
<p><a href="https://www.geeksforgeeks.org/python/python-string-lower/" class="uri">https://www.geeksforgeeks.org/python/python-string-lower/</a></p>
<p><a href="https://pandas.pydata.org/docs/user_guide/text.html?utm_source=chatgpt.com" class="uri">https://pandas.pydata.org/docs/user_guide/text.html?utm_source=chatgpt.com</a></p>
<p><a href="https://stackoverflow.com/questions/29761915/case-insensitive-pandas-dataframe-merge?utm_source=chatgpt.com" class="uri">https://stackoverflow.com/questions/29761915/case-insensitive-pandas-dataframe-merge?utm_source=chatgpt.com</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Load global top spotify song (2023) dataset</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>universal_top_spotify_songs_2023 <span class="op">=</span> pd.read_csv(<span class="st">'universal_top_spotify_songs.csv'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Show all columns of universal_top_spotify_songs_2023 </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(universal_top_spotify_songs_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['spotify_id', 'name', 'artists', 'daily_rank', 'daily_movement',
       'weekly_movement', 'country', 'snapshot_date', 'popularity',
       'is_explicit', 'duration_ms', 'album_name', 'album_release_date',
       'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness',
       'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo',
       'time_signature'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Select name, artists, country, danceability ,energy, loudness, valence, and tempo</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>spotify_2023 <span class="op">=</span> universal_top_spotify_songs_2023.<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'name'</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'artists'</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'country'</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'danceability'</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'energy'</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'loudness'</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'valence'</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'tempo'</span>])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">## Rename name column to title </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>spotify_2023 <span class="op">=</span> spotify_2023.rename(columns <span class="op">=</span> {<span class="st">'name'</span>: <span class="st">'title'</span>})</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      title  ...    tempo
0                                 Từng Quen  ...   77.010
1                      Standing Next to You  ...  106.017
2                                Like Crazy  ...  120.001
3       Seven (feat. Latto) (Explicit Ver.)  ...  124.987
4                              Slow Dancing  ...  155.960
...                                     ...  ...      ...
119801            Slime You Out (feat. SZA)  ...   88.880
119802    SAY MY GRACE (feat. Travis Scott)  ...  121.879
119803                               People  ...  124.357
119804                           Rainy Days  ...   74.828
119805                                Prada  ...  141.904

[119806 rows x 8 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['title', 'artists', 'country', 'danceability', 'energy', 'loudness',
       'valence', 'tempo'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Split the artists column and only keep the first artist</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">## For smoother joins, make following changes: </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove any white space before and after the title and artist columns</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Change the case to all lowercase for both title and artist columns</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>global_spotify_2023 <span class="op">=</span> (</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  spotify_2023</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    .assign(artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'artists'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower(),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'title'</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower())</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    .drop(columns <span class="op">=</span> [<span class="st">'artists'</span>])</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    .replace(<span class="st">" "</span>, <span class="st">""</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">## Rearrange columns </span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>global_spotify_2023 <span class="op">=</span> global_spotify_2023[[<span class="st">'title'</span>, <span class="st">'artist'</span>, <span class="st">'country'</span>, <span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'loudness'</span>, <span class="st">'valence'</span>, <span class="st">'tempo'</span>]]</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(global_spotify_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      title      artist  ... valence    tempo
0                                 từng quen  wren evans  ...   0.490   77.010
1                      standing next to you   jung kook  ...   0.816  106.017
2                                like crazy       jimin  ...   0.362  120.001
3       seven (feat. latto) (explicit ver.)   jung kook  ...   0.872  124.987
4                              slow dancing           v  ...   0.552  155.960
...                                     ...         ...  ...     ...      ...
119801            slime you out (feat. sza)       drake  ...   0.105   88.880
119802    say my grace (feat. travis scott)      offset  ...   0.476  121.879
119803                               people    libianca  ...   0.693  124.357
119804                           rainy days           v  ...   0.282   74.828
119805                                prada       cassö  ...   0.422  141.904

[119806 rows x 8 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(global_spotify_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['title', 'artist', 'country', 'danceability', 'energy', 'loudness',
       'valence', 'tempo'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="import-dataset-3" class="level2">
<h2 class="anchored" data-anchor-id="import-dataset-3">Import Dataset 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Load the world_data_2023</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>world_data_2023 <span class="op">=</span> pd.read_csv(<span class="st">'world_data_2023.csv'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(world_data_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Country', 'Density\n(P/Km2)', 'Abbreviation', 'Agricultural Land( %)',
       'Land Area(Km2)', 'Armed Forces size', 'Birth Rate', 'Calling Code',
       'Capital/Major City', 'Co2-Emissions', 'CPI', 'CPI Change (%)',
       'Currency-Code', 'Fertility Rate', 'Forested Area (%)',
       'Gasoline Price', 'GDP', 'Gross primary education enrollment (%)',
       'Gross tertiary education enrollment (%)', 'Infant mortality',
       'Largest city', 'Life expectancy', 'Maternal mortality ratio',
       'Minimum wage', 'Official language', 'Out of pocket health expenditure',
       'Physicians per thousand', 'Population',
       'Population: Labor force participation (%)', 'Tax revenue (%)',
       'Total tax rate', 'Unemployment rate', 'Urban_population', 'Latitude',
       'Longitude'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Select only the Country and Abbreviation columns</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>abbreviation_table <span class="op">=</span> world_data_2023.<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'Country'</span>, <span class="st">'Abbreviation'</span>])</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>abbreviation_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Country Abbreviation
0    Afghanistan           AF
1        Albania           AL
2        Algeria           DZ
3        Andorra           AD
4         Angola           AO
..           ...          ...
190    Venezuela           VE
191      Vietnam           VN
192        Yemen           YE
193       Zambia           ZM
194     Zimbabwe           ZW

[195 rows x 2 columns]</code></pre>
</div>
</div>
</section>
<section id="import-dataset-4" class="level2">
<h2 class="anchored" data-anchor-id="import-dataset-4">Import Dataset 4</h2>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html" class="uri">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html</a></p>
<section id="new-zealand-dataset" class="level3">
<h3 class="anchored" data-anchor-id="new-zealand-dataset">New Zealand Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Load Ireland's weekly chart for 10-16-2025</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>new_zealand_25 <span class="op">=</span> pd.read_csv(<span class="st">'10_16_25_new_zealand.csv'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_25.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Pos', 'P+', 'Artist and Title', 'Wks', 'Pk', '(x?)', 'Streams',
       'Streams+', 'Total'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Extract only the Artist.and.Title column</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Separate artist and song title from the Artist.and.Title column</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>new_zealand_filtered <span class="op">=</span> (</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  new_zealand_25</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'Artist and Title'</span>])</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  .assign(Artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist and Title'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">0</span>],</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>          Title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist and Title'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">1</span>])</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  .drop(columns <span class="op">=</span> [<span class="st">'Artist and Title'</span>])  </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_filtered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Artist                                              Title
0     Taylor Swift                                 The Fate of Ophelia
1      Olivia Dean                                          Man I Need
2     Taylor Swift                                             Opalite
3          HUNTR/X    Golden (w/ Ejae, AUDREY NUNA, REI AMI, KPop D...
4     Taylor Swift                                    Elizabeth Taylor
..              ...                                                ...
195  Tracy Chapman                                            Fast Car
196       The Game                     Hate It Or Love It (w/ 50 Cent)
197   Foo Fighters                                            Everlong
198  The Kid LAROI                                    NIGHTS LIKE THIS
199          Drake                                               NOKIA

[200 rows x 2 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_filtered.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title'], dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Split the Artist column and keep only the first artist</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove any white space before and after string</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Change both columns to all lowercase for easier matching</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>new_zealand_filtered_2025 <span class="op">=</span> (</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  new_zealand_filtered</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  .assign(Artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist'</span>].<span class="bu">str</span>.split(<span class="st">','</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower(),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>          Title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Title'</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower())  </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>new_zealand_filtered_2025</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Artist                                              Title
0     taylor swift                                the fate of ophelia
1      olivia dean                                         man i need
2     taylor swift                                            opalite
3          huntr/x  golden (w/ ejae, audrey nuna, rei ami, kpop de...
4     taylor swift                                   elizabeth taylor
..             ...                                                ...
195  tracy chapman                                           fast car
196       the game                    hate it or love it (w/ 50 cent)
197   foo fighters                                           everlong
198  the kid laroi                                   nights like this
199          drake                                              nokia

[200 rows x 2 columns]</code></pre>
</div>
</div>
</section>
<section id="south-korea-dataset" class="level3">
<h3 class="anchored" data-anchor-id="south-korea-dataset">South Korea Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Import Ireland's weekly chart for 10-16-2025</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>south_korea_2025 <span class="op">=</span> pd.read_csv(<span class="st">'10_16_25_korea.csv'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2025.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Pos', 'P+', 'Artist and Title', 'Wks', 'Pk', '(x?)', 'Streams',
       'Streams+', 'Total'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Extract only the Artist.and.Title column</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Separate artist and song title from the Artist.and.Title column</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>south_korea_filtered <span class="op">=</span> (</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  south_korea_2025</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'Artist and Title'</span>])</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  .assign(Artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist and Title'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.split(<span class="st">'-'</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">0</span>],</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>          Title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist and Title'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.split(<span class="st">'-'</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">1</span>])</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  .drop(columns <span class="op">=</span> [<span class="st">'Artist and Title'</span>])  </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>south_korea_filtered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Artist                        Title
0     Kenshi Yonezu                      IRIS OUT
1             Jimin                           Who
2     Kenshi Yonezu    JANE DOE (w/ Hikaru Utada)
3               Jin         Don’t Say You Love Me
4             Jimin                       Be Mine
..               ...                          ...
195    Kim Seungmin        Hope You're Doing Well
196           imase                  NIGHT DANCER
197    Harry Styles                     As It Was
198  GongGongGoo009                          Walk
199       Lee Mujin           Coming Of Age Story

[200 rows x 2 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Split the Artist column and keep only the first artist</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove any white space before and after string</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Change both columns to all lowercase for easier matching</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>south_korea_filtered_2025 <span class="op">=</span> (</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  south_korea_filtered</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  .assign(Artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist'</span>].<span class="bu">str</span>.split(<span class="st">','</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower(),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>          Title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Title'</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower())  </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>south_korea_filtered_2025</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Artist                       Title
0     kenshi yonezu                    iris out
1             jimin                         who
2     kenshi yonezu  jane doe (w/ hikaru utada)
3               jin       don’t say you love me
4             jimin                     be mine
..              ...                         ...
195    kim seungmin      hope you're doing well
196           imase                night dancer
197    harry styles                   as it was
198  gonggonggoo009                        walk
199       lee mujin         coming of age story

[200 rows x 2 columns]</code></pre>
</div>
</div>
</section>
<section id="usa-dataset" class="level3">
<h3 class="anchored" data-anchor-id="usa-dataset">USA Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Import Ireland's weekly chart for 10-16-2025</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>usa_25 <span class="op">=</span> pd.read_csv(<span class="st">'10_16_25_usa.csv'</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Pos  P+  ...     Streams+        Total
0      1   =  ...  -23,507,117   74,518,323
1      2   =  ...  -19,984,458   60,049,010
2      3   =  ...  -21,131,889   52,442,017
3      4   =  ...  -19,813,688   49,617,088
4      5   =  ...  -17,882,079   42,591,575
..   ...  ..  ...          ...          ...
195  196   =  ...      -66,220   85,096,682
196  197  RE  ...          NaN  369,291,695
197  198  RE  ...          NaN  221,065,088
198  199  RE  ...          NaN    4,143,947
199  200  RE  ...          NaN  110,735,068

[200 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_25.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Pos', 'P+', 'Artist and Title', 'Wks', 'Pk', '(x?)', 'Streams',
       'Streams+', 'Total'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Extract only the Artist.and.Title column</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Separate artist and song title from the Artist.and.Title column</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>usa_filtered <span class="op">=</span> (</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  usa_25</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'Artist and Title'</span>])</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  .assign(Artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist and Title'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">0</span>],</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>          Title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist and Title'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">1</span>])</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  .drop(columns <span class="op">=</span> [<span class="st">'Artist and Title'</span>])  </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>usa_filtered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Artist                               Title
0      Taylor Swift                  The Fate of Ophelia
1      Taylor Swift                              Opalite
2      Taylor Swift                     Elizabeth Taylor
3      Taylor Swift                        Father Figure
4      Taylor Swift                                 Wood
..               ...                                 ...
195   Daniel Caesar              Get You (w/ Kali Uchis)
196      Luke Combs                             Fast Car
197  Tucker Wetmore                  Wind Up Missin’ You
198      ROLE MODEL        Sally, When The Wine Runs Out
199     BigXthaPlug    All The Way (w/ Bailey Zimmerman)

[200 rows x 2 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Split the Artist column and keep only the first artist</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove any white space before and after string</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Change both columns to all lowercase for easier matching</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>usa_filtered_2025 <span class="op">=</span> (</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  usa_filtered</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  .assign(Artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Artist'</span>].<span class="bu">str</span>.split(<span class="st">','</span>,  n <span class="op">=</span> <span class="dv">1</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower(),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>          Title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'Title'</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower())   </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>usa_filtered_2025</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Artist                              Title
0      taylor swift                the fate of ophelia
1      taylor swift                            opalite
2      taylor swift                   elizabeth taylor
3      taylor swift                      father figure
4      taylor swift                               wood
..              ...                                ...
195   daniel caesar            get you (w/ kali uchis)
196      luke combs                           fast car
197  tucker wetmore                wind up missin’ you
198      role model      sally, when the wine runs out
199     bigxthaplug  all the way (w/ bailey zimmerman)

[200 rows x 2 columns]</code></pre>
</div>
</div>
</section>
</section>
<section id="import-wrangle-dataset-5---universal-top-spotify-songs-kaggle" class="level2">
<h2 class="anchored" data-anchor-id="import-wrangle-dataset-5---universal-top-spotify-songs-kaggle">Import &amp; Wrangle Dataset 5 - Universal Top Spotify Songs (Kaggle)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Import the Universal Top Spotify Songs dataset</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>universal_top_spotify_songs <span class="op">=</span> pd.read_csv(<span class="st">'universal_top_spotify_songs.csv'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(universal_top_spotify_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    spotify_id  ... time_signature
0       3un8UkiPHJjlsrTHQnisXH  ...              4
1       2KslE17cAJNHTsI2MI0jb2  ...              4
2       3Ua0m0YmEjrMi9XErKcNiR  ...              4
3       2HRgqmZQC0MC7GeNuDIXHN  ...              4
4       5h1BN75CEh8wdSwE1xrbSe  ...              4
...                        ...  ...            ...
119801  0AYt6NMyyLd0rLuvr0UkMH  ...              3
119802  2Gk6fi0dqt91NKvlzGsmm7  ...              4
119803  26b3oVLrRUaaybJulow9kz  ...              5
119804  5ydjxBSUIDn26MFzU3asP4  ...              4
119805  59NraMJsLaMCVtwXTSia8i  ...              4

[119806 rows x 25 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(universal_top_spotify_songs.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['spotify_id', 'name', 'artists', 'daily_rank', 'daily_movement',
       'weekly_movement', 'country', 'snapshot_date', 'popularity',
       'is_explicit', 'duration_ms', 'album_name', 'album_release_date',
       'danceability', 'energy', 'key', 'loudness', 'mode', 'speechiness',
       'acousticness', 'instrumentalness', 'liveness', 'valence', 'tempo',
       'time_signature'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Keep following columns only:</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">## name, artists, danceability, energy, loudness, liveness, tempo</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove any white space before and after string</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Change both columns to all lowercase for easier matching</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>spotify_2025_py_cleaned <span class="op">=</span> (</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  universal_top_spotify_songs</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  .assign(artist <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'artists'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower())</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  .assign(title <span class="op">=</span> <span class="kw">lambda</span> df_: df_[<span class="st">'name'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.strip().<span class="bu">str</span>.lower())</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(items <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>, <span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'loudness'</span>, <span class="st">'valence'</span>, <span class="st">'tempo'</span>])</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_2025_py_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      title      artist  ...  valence    tempo
0                                 từng quen  wren evans  ...    0.490   77.010
1                      standing next to you   jung kook  ...    0.816  106.017
2                                like crazy       jimin  ...    0.362  120.001
3       seven (feat. latto) (explicit ver.)   jung kook  ...    0.872  124.987
4                              slow dancing           v  ...    0.552  155.960
...                                     ...         ...  ...      ...      ...
119801            slime you out (feat. sza)       drake  ...    0.105   88.880
119802    say my grace (feat. travis scott)      offset  ...    0.476  121.879
119803                               people    libianca  ...    0.693  124.357
119804                           rainy days           v  ...    0.282   74.828
119805                                prada       cassö  ...    0.422  141.904

[119806 rows x 7 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_2025_py_cleaned.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['title', 'artist', 'danceability', 'energy', 'loudness', 'valence',
       'tempo'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="combine-dataset-2-and-3---replace-country-abbreviation-with-its-full-name" class="level2">
<h2 class="anchored" data-anchor-id="combine-dataset-2-and-3---replace-country-abbreviation-with-its-full-name">Combine dataset 2 and 3 - replace country abbreviation with its full name</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Match spotify's country abbreviation with abbreviation table's abbreviation</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop abbreviation column</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Rearrange country column to the front</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove any unmatched rows</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>spotify_global_2023_matched <span class="op">=</span> (</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  global_spotify_2023</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  .merge(abbreviation_table,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>         left_on <span class="op">=</span> [<span class="st">'country'</span>],</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>         right_on <span class="op">=</span> [<span class="st">'Abbreviation'</span>],</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>         how <span class="op">=</span> <span class="st">'left'</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  .drop(columns <span class="op">=</span> [<span class="st">'country'</span>, </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Abbreviation'</span>])</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  .dropna()</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_global_2023_matched)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      title  ...               Country
0                                 từng quen  ...               Vietnam
1                      standing next to you  ...               Vietnam
2                                like crazy  ...               Vietnam
3       seven (feat. latto) (explicit ver.)  ...               Vietnam
4                              slow dancing  ...               Vietnam
...                                     ...  ...                   ...
129413            slime you out (feat. sza)  ...  United Arab Emirates
129414    say my grace (feat. travis scott)  ...  United Arab Emirates
129415                               people  ...  United Arab Emirates
129416                           rainy days  ...  United Arab Emirates
129417                                prada  ...  United Arab Emirates

[124490 rows x 8 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_global_2023_matched.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['title', 'artist', 'danceability', 'energy', 'loudness', 'valence',
       'tempo', 'Country'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="calculate-mean-danceability-energy-loudness-valence-and-tempo-by-country-for-2023-spotify-dataset" class="level2">
<h2 class="anchored" data-anchor-id="calculate-mean-danceability-energy-loudness-valence-and-tempo-by-country-for-2023-spotify-dataset">Calculate mean danceability, energy, loudness, valence, and tempo by Country for 2023 Spotify Dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate averages of spotify_global_2023_matched </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">## dataset by Country</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>spotify_global_2023_avg <span class="op">=</span> (</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  spotify_global_2023_matched</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'Country'</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    .agg(danceability_avg <span class="op">=</span> (<span class="st">'danceability'</span>, <span class="st">'mean'</span>),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>         energy_avg <span class="op">=</span> (<span class="st">'energy'</span>, <span class="st">'mean'</span>),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>         loudness_avg <span class="op">=</span> (<span class="st">'loudness'</span>, <span class="st">'mean'</span>),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>         valence_avg <span class="op">=</span> (<span class="st">'valence'</span>, <span class="st">'mean'</span>),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>         tempo_avg <span class="op">=</span> (<span class="st">'tempo'</span>, <span class="st">'mean'</span>))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_global_2023_avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               danceability_avg  energy_avg  ...  valence_avg   tempo_avg
Country                                      ...                         
Argentina              0.750906    0.669080  ...     0.641409  114.941918
Australia              0.642351    0.633166  ...     0.496816  123.108889
Austria                0.682151    0.649667  ...     0.493569  126.064716
Belarus                0.685702    0.660806  ...     0.519015  124.288601
Belgium                0.641654    0.659068  ...     0.505973  125.798881
...                         ...         ...  ...          ...         ...
United States          0.641520    0.626548  ...     0.450932  125.375067
Uruguay                0.743333    0.663681  ...     0.649936  113.609218
Vatican City           0.665798    0.639945  ...     0.488641  118.471851
Venezuela              0.766245    0.679643  ...     0.532675  122.744222
Vietnam                0.708159    0.522437  ...     0.501456  120.704650

[76 rows x 5 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spotify_global_2023_avg.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['danceability_avg', 'energy_avg', 'loudness_avg', 'valence_avg',
       'tempo_avg'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="join-2025-spotify-dataset-to-country-datasets-for-2025-happiness-analysis" class="level2">
<h2 class="anchored" data-anchor-id="join-2025-spotify-dataset-to-country-datasets-for-2025-happiness-analysis">Join 2025 Spotify Dataset to Country Datasets for 2025 Happiness Analysis</h2>
<p><a href="https://stackoverflow.com/questions/60006995/round-while-groupping-by-in-pandas-with-agg-function?utm_source=chatgpt.com" class="uri">https://stackoverflow.com/questions/60006995/round-while-groupping-by-in-pandas-with-agg-function?utm_source=chatgpt.com</a></p>
<section id="new-zealand-dataset-1" class="level3">
<h3 class="anchored" data-anchor-id="new-zealand-dataset-1"><strong>New Zealand</strong> Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Join New Zealand dataframe and updated Spotify dataframe</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Left join to keep all the rows of left dataframe</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>new_zealand_2025_matched <span class="op">=</span> new_zealand_filtered_2025.merge(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    spotify_2025_py_cleaned,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    left_on <span class="op">=</span> [<span class="st">'Title'</span>, <span class="st">'Artist'</span>],</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    right_on <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>],</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    how <span class="op">=</span> <span class="st">'left'</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2025_matched)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Artist  ... tempo
0      taylor swift  ...   NaN
1       olivia dean  ...   NaN
2      taylor swift  ...   NaN
3           huntr/x  ...   NaN
4      taylor swift  ...   NaN
...             ...  ...   ...
4427  tracy chapman  ...   NaN
4428       the game  ...   NaN
4429   foo fighters  ...   NaN
4430  the kid laroi  ...   NaN
4431          drake  ...   NaN

[4432 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2025_matched.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title', 'title', 'artist', 'danceability', 'energy',
       'loudness', 'valence', 'tempo'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Clean up the joined dataframe</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop title and artist columns from new_zealand_2025_matched</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop duplicate rows and songs with no analytic data</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Add Country and year column for aggretation and future analysis</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>new_zealand_2025_matched_cleaned <span class="op">=</span> (</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  new_zealand_2025_matched</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    .drop(columns <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>])</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates(subset <span class="op">=</span> [<span class="st">'Title'</span>, <span class="st">'Artist'</span>])</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    .dropna(subset <span class="op">=</span> [<span class="st">'danceability'</span>])</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    .assign(Country <span class="op">=</span> <span class="st">"New Zealand"</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>            year <span class="op">=</span> <span class="dv">2025</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop <span class="op">=</span> <span class="va">True</span>) </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2025_matched_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Artist  ...  year
0                  fleetwood mac  ...  2025
1                    teddy swims  ...  2025
2              the goo goo dolls  ...  2025
3                    the killers  ...  2025
4                  fleetwood mac  ...  2025
5          red hot chili peppers  ...  2025
6                  kings of leon  ...  2025
7                chris stapleton  ...  2025
8                     zach bryan  ...  2025
9                  fleetwood mac  ...  2025
10                      coldplay  ...  2025
11                        l.a.b.  ...  2025
12  creedence clearwater revival  ...  2025
13                      coldplay  ...  2025
14                    lord huron  ...  2025
15         red hot chili peppers  ...  2025
16                 lewis capaldi  ...  2025
17         red hot chili peppers  ...  2025
18             the neighbourhood  ...  2025
19                          toto  ...  2025
20                   frank ocean  ...  2025
21                        hozier  ...  2025
22                     vance joy  ...  2025
23                        miguel  ...  2025
24               tears for fears  ...  2025
25                    tate mcrae  ...  2025
26                    luke combs  ...  2025
27                    bruno mars  ...  2025
28                       j. cole  ...  2025
29                           sza  ...  2025
30         red hot chili peppers  ...  2025
31                    noah kahan  ...  2025
32                      coldplay  ...  2025
33                   frank ocean  ...  2025
34         red hot chili peppers  ...  2025
35                      corrella  ...  2025

[36 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2025_matched_cleaned.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title', 'danceability', 'energy', 'loudness', 'valence',
       'tempo', 'Country', 'year'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate average for each column</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Add Country and year columns for identification</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Will be used later for 2023 and 2025 comparison</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>new_zealand_2025_avg <span class="op">=</span> (</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  new_zealand_2025_matched_cleaned</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'Country'</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    .agg(danceability_avg <span class="op">=</span> (<span class="st">'danceability'</span>, <span class="st">'mean'</span>),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>         energy_avg <span class="op">=</span> (<span class="st">'energy'</span>, <span class="st">'mean'</span>),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>         loudness_avg <span class="op">=</span> (<span class="st">'loudness'</span>, <span class="st">'mean'</span>),</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>         valence_avg <span class="op">=</span> (<span class="st">'valence'</span>, <span class="st">'mean'</span>),</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>         tempo_avg <span class="op">=</span> (<span class="st">'tempo'</span>, <span class="st">'mean'</span>),</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>         year <span class="op">=</span> (<span class="st">'year'</span>, <span class="st">'mean'</span>))   <span class="co">## Every year value is 2025; this line was added for uniformity</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    .reset_index()  <span class="co"># Need the Country as its own column</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2025_avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Country  danceability_avg  energy_avg  ...  valence_avg   tempo_avg    year
0  New Zealand          0.601778    0.609389  ...     0.533306  120.254111  2025.0

[1 rows x 7 columns]</code></pre>
</div>
</div>
</section>
<section id="south-korea-dataset-1" class="level3">
<h3 class="anchored" data-anchor-id="south-korea-dataset-1">South Korea Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Join South Korea dataframe and updated Spotify dataframe</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Left join to keep all the rows of left dataframe</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>south_korea_2025_matched <span class="op">=</span> south_korea_filtered_2025.merge(</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    spotify_2025_py_cleaned,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    left_on <span class="op">=</span> [<span class="st">'Title'</span>, <span class="st">'Artist'</span>],</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    right_on <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>],</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    how <span class="op">=</span> <span class="st">'left'</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2025_matched)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Artist                       Title  ... valence   tempo
0      kenshi yonezu                    iris out  ...     NaN     NaN
1              jimin                         who  ...     NaN     NaN
2      kenshi yonezu  jane doe (w/ hikaru utada)  ...     NaN     NaN
3                jin       don’t say you love me  ...     NaN     NaN
4              jimin                     be mine  ...     NaN     NaN
...              ...                         ...  ...     ...     ...
3235    harry styles                   as it was  ...   0.662  173.93
3236    harry styles                   as it was  ...   0.662  173.93
3237    harry styles                   as it was  ...   0.662  173.93
3238  gonggonggoo009                        walk  ...     NaN     NaN
3239       lee mujin         coming of age story  ...     NaN     NaN

[3240 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2025_matched.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title', 'title', 'artist', 'danceability', 'energy',
       'loudness', 'valence', 'tempo'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Clean up the joined dataframe</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop title and artist columns from south_korea_2025_matched</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop duplicate rows and songs with no analytic data</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Add Country and year column for aggretation and future analysis</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>south_korea_2025_matched_cleaned <span class="op">=</span> (</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  south_korea_2025_matched</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    .drop(columns <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>])</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates(subset <span class="op">=</span> [<span class="st">'Title'</span>, <span class="st">'Artist'</span>])</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    .dropna(subset <span class="op">=</span> [<span class="st">'danceability'</span>])</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    .assign(Country <span class="op">=</span> <span class="st">"South Korea"</span>,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>            year <span class="op">=</span> <span class="dv">2025</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)  <span class="co">## No longer need the old index</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2025_matched_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Artist                 Title  ...      Country  year
0            jimin            like crazy  ...  South Korea  2025
1        jung kook  standing next to you  ...  South Korea  2025
2             d4vd          here with me  ...  South Korea  2025
3         newjeans                 ditto  ...  South Korea  2025
4         newjeans              hype boy  ...  South Korea  2025
5           vaundy                   踊り子  ...  South Korea  2025
6            yuuri                ベテルギウス  ...  South Korea  2025
7         newjeans                   omg  ...  South Korea  2025
8        jung kook        still with you  ...  South Korea  2025
9            tuki.                   晩餐歌  ...  South Korea  2025
10        newjeans             new jeans  ...  South Korea  2025
11        newjeans                   eta  ...  South Korea  2025
12        newjeans             super shy  ...  South Korea  2025
13      the weeknd       blinding lights  ...  South Korea  2025
14      the weeknd           die for you  ...  South Korea  2025
15           dhruv           double take  ...  South Korea  2025
16     onerepublic       i ain't worried  ...  South Korea  2025
17    taylor swift          cruel summer  ...  South Korea  2025
18  tatsuya kitani                 青のすみか  ...  South Korea  2025
19    harry styles             as it was  ...  South Korea  2025

[20 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2025_matched_cleaned.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title', 'danceability', 'energy', 'loudness', 'valence',
       'tempo', 'Country', 'year'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate average for each column</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Add Country and year columns for identification</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Will be used later for 2023 and 2025 comparison</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>south_korea_2025_avg <span class="op">=</span> (</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  south_korea_2025_matched_cleaned</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'Country'</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    .agg(danceability_avg <span class="op">=</span> (<span class="st">'danceability'</span>, <span class="st">'mean'</span>),</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>         energy_avg <span class="op">=</span> (<span class="st">'energy'</span>, <span class="st">'mean'</span>),</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>         loudness_avg <span class="op">=</span> (<span class="st">'loudness'</span>, <span class="st">'mean'</span>),</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>         valence_avg <span class="op">=</span> (<span class="st">'valence'</span>, <span class="st">'mean'</span>),</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>         tempo_avg <span class="op">=</span> (<span class="st">'tempo'</span>, <span class="st">'mean'</span>),</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>         year <span class="op">=</span> (<span class="st">'year'</span>, <span class="st">'mean'</span>))   <span class="co">## Every year value is 2025; this line was added for uniformity)</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    .reset_index()   <span class="co"># Need the Country as its own column</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2025_avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Country  danceability_avg  energy_avg  ...  valence_avg  tempo_avg    year
0  South Korea           0.63925     0.68755  ...      0.55745   135.7617  2025.0

[1 rows x 7 columns]</code></pre>
</div>
</div>
</section>
<section id="usa-dataset-1" class="level3">
<h3 class="anchored" data-anchor-id="usa-dataset-1">USA Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Join South Korea dataframe and updated Spotify dataframe</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Left join to keep all the rows of left dataframe</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>usa_2025_matched <span class="op">=</span> usa_filtered_2025.merge(</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    spotify_2025_py_cleaned,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    left_on <span class="op">=</span> [<span class="st">'Title'</span>, <span class="st">'Artist'</span>],</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    right_on <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>],</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    how <span class="op">=</span> <span class="st">'left'</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2025_matched)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Artist                              Title  ... valence   tempo
0       taylor swift                the fate of ophelia  ...     NaN     NaN
1       taylor swift                            opalite  ...     NaN     NaN
2       taylor swift                   elizabeth taylor  ...     NaN     NaN
3       taylor swift                      father figure  ...     NaN     NaN
4       taylor swift                               wood  ...     NaN     NaN
...              ...                                ...  ...     ...     ...
5125      luke combs                           fast car  ...    0.67  97.994
5126      luke combs                           fast car  ...    0.67  97.994
5127  tucker wetmore                wind up missin’ you  ...     NaN     NaN
5128      role model      sally, when the wine runs out  ...     NaN     NaN
5129     bigxthaplug  all the way (w/ bailey zimmerman)  ...     NaN     NaN

[5130 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2025_matched.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title', 'title', 'artist', 'danceability', 'energy',
       'loudness', 'valence', 'tempo'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Clean up the joined dataframe</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop title and artist columns from usa_2025_matched</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop duplicate rows and songs with no analytic data</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Add Country and year column for aggretation and future analysis</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>usa_2025_matched_cleaned <span class="op">=</span> (</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  usa_2025_matched</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    .drop(columns <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'artist'</span>])</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates(subset <span class="op">=</span> [<span class="st">'Title'</span>, <span class="st">'Artist'</span>])</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    .dropna(subset <span class="op">=</span> [<span class="st">'danceability'</span>])</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    .assign(Country <span class="op">=</span> <span class="st">"United States"</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>            year <span class="op">=</span> <span class="dv">2025</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop <span class="op">=</span> <span class="va">True</span>)    <span class="co">## No longer need the old index</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2025_matched_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Artist  ...  year
0           fleetwood mac  ...  2025
1       the goo goo dolls  ...  2025
2       the neighbourhood  ...  2025
3                coldplay  ...  2025
4             the killers  ...  2025
5             teddy swims  ...  2025
6              zach bryan  ...  2025
7             girl in red  ...  2025
8          arctic monkeys  ...  2025
9              tate mcrae  ...  2025
10             noah kahan  ...  2025
11        chris stapleton  ...  2025
12               coldplay  ...  2025
13   cigarettes after sex  ...  2025
14             lord huron  ...  2025
15                tv girl  ...  2025
16              vance joy  ...  2025
17                 hozier  ...  2025
18             tory lanez  ...  2025
19                j. cole  ...  2025
20            frank ocean  ...  2025
21  red hot chili peppers  ...  2025
22                   d4vd  ...  2025
23          morgan wallen  ...  2025
24             hotel ugly  ...  2025
25         arctic monkeys  ...  2025
26        tears for fears  ...  2025
27             steve lacy  ...  2025
28                    sza  ...  2025
29             kanye west  ...  2025
30             the weeknd  ...  2025
31             bruno mars  ...  2025
32             luke combs  ...  2025

[33 rows x 9 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2025_matched_cleaned.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Artist', 'Title', 'danceability', 'energy', 'loudness', 'valence',
       'tempo', 'Country', 'year'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate average for each column</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Add Country and year columns for identification</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Will be used later for 2023 and 2025 comparison</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>usa_2025_avg <span class="op">=</span> (</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  usa_2025_matched_cleaned</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'Country'</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    .agg(danceability_avg <span class="op">=</span> (<span class="st">'danceability'</span>, <span class="st">'mean'</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>         energy_avg <span class="op">=</span> (<span class="st">'energy'</span>, <span class="st">'mean'</span>),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>         loudness_avg <span class="op">=</span> (<span class="st">'loudness'</span>, <span class="st">'mean'</span>),</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>         valence_avg <span class="op">=</span> (<span class="st">'valence'</span>, <span class="st">'mean'</span>),</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>         tempo_avg <span class="op">=</span> (<span class="st">'tempo'</span>, <span class="st">'mean'</span>),</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>         year <span class="op">=</span> (<span class="st">'year'</span>, <span class="st">'mean'</span>))     <span class="co">## Every year value is 2025; this line was added for uniformity</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    .reset_index()   <span class="co"># Need the Country as its own column</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2025_avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Country  danceability_avg  energy_avg  ...  valence_avg   tempo_avg    year
0  United States          0.556333    0.591606  ...     0.460667  124.565364  2025.0

[1 rows x 7 columns]</code></pre>
</div>
</div>
</section>
</section>
<section id="correlation-studies" class="level2">
<h2 class="anchored" data-anchor-id="correlation-studies">Correlation Studies</h2>
<p>References:</p>
<p><a href="https://seaborn.pydata.org/generated/seaborn.heatmap.html" class="uri">https://seaborn.pydata.org/generated/seaborn.heatmap.html</a></p>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html" class="uri">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html</a></p>
<p><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html" class="uri">https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html</a></p>
<p><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html" class="uri">https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html</a></p>
<p><a href="https://www.datacamp.com/tutorial/seaborn-heatmaps" class="uri">https://www.datacamp.com/tutorial/seaborn-heatmaps</a></p>
<p><a href="https://www.geeksforgeeks.org/python/change-the-order-of-a-pandas-dataframe-columns-in-python/" class="uri">https://www.geeksforgeeks.org/python/change-the-order-of-a-pandas-dataframe-columns-in-python/</a></p>
<p><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html" class="uri">https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html</a></p>
<p><a href="https://matplotlib.org/stable/users/explain/colors/colormaps.html" class="uri">https://matplotlib.org/stable/users/explain/colors/colormaps.html</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Install matplotlib and seaborn for correlation heatmap analysis</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#reticulate::py_install(c("matplotlib", "seaborn"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="preparing-datasets-for-correlation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="preparing-datasets-for-correlation-analysis">Preparing Datasets for Correlation Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Left join spotify_global_2023_avg with Happiness_report_23</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>happiness_spotify_2023_pd <span class="op">=</span> spotify_global_2023_avg.merge(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  Happiness_report_23,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  left_on <span class="op">=</span> [<span class="st">'Country'</span>],</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  right_on <span class="op">=</span> [<span class="st">'country_name'</span>],</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  how <span class="op">=</span> <span class="st">'left'</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(happiness_spotify_2023_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    danceability_avg  energy_avg  loudness_avg  ...  life_exp  freedom generosity
0           0.750906    0.669080     -5.424518  ...    67.200    0.823     -0.089
1           0.642351    0.633166     -6.949162  ...    71.050    0.890      0.198
2           0.682151    0.649667     -7.024091  ...    71.150    0.855      0.102
3           0.685702    0.660806     -6.556709  ...       NaN      NaN        NaN
4           0.641654    0.659068     -6.594978  ...    70.899    0.825      0.001
..               ...         ...           ...  ...       ...      ...        ...
71          0.641520    0.626548     -6.916220  ...    65.850    0.800      0.137
72          0.743333    0.663681     -5.437963  ...    67.500    0.895     -0.065
73          0.665798    0.639945     -6.662540  ...       NaN      NaN        NaN
74          0.766245    0.679643     -5.444477  ...    64.050    0.659      0.128
75          0.708159    0.522437     -8.721408  ...    65.502    0.939     -0.004

[76 rows x 12 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(happiness_spotify_2023_pd.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['danceability_avg', 'energy_avg', 'loudness_avg', 'valence_avg',
       'tempo_avg', 'country_name', 'happiness_score', 'gdp_wellbeing',
       'social_support', 'life_exp', 'freedom', 'generosity'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="analyzing-correlations-in-the-top-10-happiness-score-countries" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-correlations-in-the-top-10-happiness-score-countries">Analyzing Correlations in the Top 10 Happiness Score Countries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Select top 10 countries with highest happiness_score</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Rearrange columns for more intuitive understanding</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>top_happiness_score_spotify_23 <span class="op">=</span> (</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  happiness_spotify_2023_pd</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  .sort_values(<span class="st">'happiness_score'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">10</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  [[<span class="st">'country_name'</span>, <span class="st">'danceability_avg'</span>, <span class="st">'energy_avg'</span>, <span class="st">'loudness_avg'</span>, <span class="st">'valence_avg'</span>,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">'tempo_avg'</span>, <span class="st">'happiness_score'</span>, <span class="st">'gdp_wellbeing'</span>,</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>       <span class="st">'social_support'</span>, <span class="st">'life_exp'</span>, <span class="st">'freedom'</span>, <span class="st">'generosity'</span>]]</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  .reset_index(drop <span class="op">=</span> <span class="va">True</span>)    <span class="co">## No longer need the old index</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_happiness_score_spotify_23)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country_name  danceability_avg  energy_avg  ...  life_exp  freedom  generosity
0      Finland          0.713790    0.671749  ...    71.150    0.961      -0.019
1      Denmark          0.708282    0.658628  ...    71.250    0.934       0.134
2      Iceland          0.676423    0.480747  ...    72.050    0.936       0.211
3       Israel          0.588099    0.517123  ...    72.697    0.809      -0.023
4  Netherlands          0.652137    0.676558  ...    71.550    0.887       0.213
5       Sweden          0.619904    0.537530  ...    72.150    0.948       0.165
6       Norway          0.619545    0.592718  ...    71.500    0.947       0.141
7  Switzerland          0.664222    0.640184  ...    72.900    0.891       0.027
8   Luxembourg          0.673004    0.659522  ...    71.675    0.915       0.024
9  New Zealand          0.657780    0.634505  ...    70.350    0.887       0.175

[10 rows x 12 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_happiness_score_spotify_23.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['country_name', 'danceability_avg', 'energy_avg', 'loudness_avg',
       'valence_avg', 'tempo_avg', 'happiness_score', 'gdp_wellbeing',
       'social_support', 'life_exp', 'freedom', 'generosity'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop the country_name column for correltion analysis</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>top_happiness_score_spotify_23_cleaned <span class="op">=</span> top_happiness_score_spotify_23.drop(columns <span class="op">=</span> [<span class="st">'country_name'</span>])</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_happiness_score_spotify_23_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   danceability_avg  energy_avg  loudness_avg  ...  life_exp  freedom  generosity
0          0.713790    0.671749     -6.132559  ...    71.150    0.961      -0.019
1          0.708282    0.658628     -6.340489  ...    71.250    0.934       0.134
2          0.676423    0.480747     -9.070748  ...    72.050    0.936       0.211
3          0.588099    0.517123     -8.436637  ...    72.697    0.809      -0.023
4          0.652137    0.676558     -6.545548  ...    71.550    0.887       0.213
5          0.619904    0.537530     -8.296959  ...    72.150    0.948       0.165
6          0.619545    0.592718     -7.459607  ...    71.500    0.947       0.141
7          0.664222    0.640184     -6.634767  ...    72.900    0.891       0.027
8          0.673004    0.659522     -6.393453  ...    71.675    0.915       0.024
9          0.657780    0.634505     -6.839719  ...    70.350    0.887       0.175

[10 rows x 11 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_happiness_score_spotify_23_cleaned.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['danceability_avg', 'energy_avg', 'loudness_avg', 'valence_avg',
       'tempo_avg', 'happiness_score', 'gdp_wellbeing', 'social_support',
       'life_exp', 'freedom', 'generosity'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Correlation analysis</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>top_happiness_countries_23_corr <span class="op">=</span> top_happiness_score_spotify_23_cleaned.corr()</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_happiness_countries_23_corr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  danceability_avg  energy_avg  ...   freedom  generosity
danceability_avg          1.000000    0.551430  ...  0.549908   -0.017513
energy_avg                0.551430    1.000000  ...  0.158623   -0.176553
loudness_avg              0.589888    0.990698  ...  0.166685   -0.271549
valence_avg               0.942433    0.645206  ...  0.563037    0.063489
tempo_avg                -0.417701    0.206855  ... -0.222265    0.370573
happiness_score           0.410646   -0.058028  ...  0.322147   -0.216992
gdp_wellbeing             0.210186    0.339537  ...  0.258326   -0.163353
social_support            0.183122   -0.402586  ...  0.235605    0.306781
life_exp                 -0.436719   -0.476399  ... -0.357327   -0.344010
freedom                   0.549908    0.158623  ...  1.000000    0.282188
generosity               -0.017513   -0.176553  ...  0.282188    1.000000

[11 rows x 11 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Create a heatmap using Seaborn</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(top_happiness_countries_23_corr, </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>            vmin <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>            vmax <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>            center <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>            annot <span class="op">=</span><span class="va">True</span>,</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>            cmap <span class="op">=</span> <span class="st">'bwr_r'</span>,</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>            cbar_kws <span class="op">=</span> {<span class="st">'label'</span>: <span class="st">'Correlation'</span>},</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>            square <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>            linewidths <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>            annot_kws<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">6</span>})</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co">## Rotate x-axis labels</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation <span class="op">=</span> <span class="dv">45</span>, ha <span class="op">=</span> <span class="st">'right'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ 0.5,  1.5,  2.5,  3.5,  4.5,  5.5,  6.5,  7.5,  8.5,  9.5, 10.5]), [Text(0.5, 0, 'danceability_avg'), Text(1.5, 0, 'energy_avg'), Text(2.5, 0, 'loudness_avg'), Text(3.5, 0, 'valence_avg'), Text(4.5, 0, 'tempo_avg'), Text(5.5, 0, 'happiness_score'), Text(6.5, 0, 'gdp_wellbeing'), Text(7.5, 0, 'social_support'), Text(8.5, 0, 'life_exp'), Text(9.5, 0, 'freedom'), Text(10.5, 0, 'generosity')])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Rotate y-axis labels</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>plt.yticks(va <span class="op">=</span> <span class="st">'center'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ 0.5,  1.5,  2.5,  3.5,  4.5,  5.5,  6.5,  7.5,  8.5,  9.5, 10.5]), [Text(0, 0.5, 'danceability_avg'), Text(0, 1.5, 'energy_avg'), Text(0, 2.5, 'loudness_avg'), Text(0, 3.5, 'valence_avg'), Text(0, 4.5, 'tempo_avg'), Text(0, 5.5, 'happiness_score'), Text(0, 6.5, 'gdp_wellbeing'), Text(0, 7.5, 'social_support'), Text(0, 8.5, 'life_exp'), Text(0, 9.5, 'freedom'), Text(0, 10.5, 'generosity')])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Wrangling-Final-Project---Python-Pandas-ver-3-copy_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analyzing-correlations-in-the-bottom-10-happiness-score-countries" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-correlations-in-the-bottom-10-happiness-score-countries">Analyzing Correlations in the Bottom 10 Happiness Score Countries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Select top 10 countries with highest happiness_score</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Rearrange columns for more intuitive understanding</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>bottom_happiness_score_spotify_23 <span class="op">=</span> (</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  happiness_spotify_2023_pd</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  .sort_values(<span class="st">'happiness_score'</span>, ascending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">10</span>)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  [[<span class="st">'country_name'</span>, <span class="st">'danceability_avg'</span>, <span class="st">'energy_avg'</span>, <span class="st">'loudness_avg'</span>, <span class="st">'valence_avg'</span>,</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">'tempo_avg'</span>, <span class="st">'happiness_score'</span>, <span class="st">'gdp_wellbeing'</span>,</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>       <span class="st">'social_support'</span>, <span class="st">'life_exp'</span>, <span class="st">'freedom'</span>, <span class="st">'generosity'</span>]]</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  .reset_index(drop <span class="op">=</span> <span class="va">True</span>)     <span class="co">## No longer need the old index</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bottom_happiness_score_spotify_23)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      country_name  danceability_avg  energy_avg  ...  life_exp  freedom  generosity
0            India          0.673318    0.620333  ...    60.777    0.897       0.072
1            Egypt          0.702365    0.668444  ...    63.503    0.732      -0.183
2         Pakistan          0.718347    0.587097  ...    57.313    0.766       0.008
3          Namibia          0.665798    0.639945  ...    56.851    0.669      -0.126
4          Morocco          0.700788    0.619234  ...    63.901    0.787      -0.231
5          Nigeria          0.772726    0.688686  ...    54.891    0.718       0.073
6          Ukraine          0.720419    0.652038  ...    64.550    0.795       0.240
7        Venezuela          0.766245    0.679643  ...    64.050    0.659       0.128
8  North Macedonia          0.665798    0.639945  ...    66.500    0.769       0.131
9     South Africa          0.726454    0.579644  ...    56.989    0.730      -0.087

[10 rows x 12 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bottom_happiness_score_spotify_23.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['country_name', 'danceability_avg', 'energy_avg', 'loudness_avg',
       'valence_avg', 'tempo_avg', 'happiness_score', 'gdp_wellbeing',
       'social_support', 'life_exp', 'freedom', 'generosity'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Drop the country_name column for correltion analysis</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>bottom_happiness_score_spotify_23_cleaned <span class="op">=</span> bottom_happiness_score_spotify_23.drop(columns <span class="op">=</span> [<span class="st">'country_name'</span>])</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bottom_happiness_score_spotify_23_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   danceability_avg  energy_avg  loudness_avg  ...  life_exp  freedom  generosity
0          0.673318    0.620333     -7.006064  ...    60.777    0.897       0.072
1          0.702365    0.668444     -6.467412  ...    63.503    0.732      -0.183
2          0.718347    0.587097     -7.686563  ...    57.313    0.766       0.008
3          0.665798    0.639945     -6.662540  ...    56.851    0.669      -0.126
4          0.700788    0.619234     -7.871914  ...    63.901    0.787      -0.231
5          0.772726    0.688686     -7.111078  ...    54.891    0.718       0.073
6          0.720419    0.652038     -7.023956  ...    64.550    0.795       0.240
7          0.766245    0.679643     -5.444477  ...    64.050    0.659       0.128
8          0.665798    0.639945     -6.662540  ...    66.500    0.769       0.131
9          0.726454    0.579644     -9.766683  ...    56.989    0.730      -0.087

[10 rows x 11 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bottom_happiness_score_spotify_23_cleaned.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['danceability_avg', 'energy_avg', 'loudness_avg', 'valence_avg',
       'tempo_avg', 'happiness_score', 'gdp_wellbeing', 'social_support',
       'life_exp', 'freedom', 'generosity'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Correlation analysis</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>bot_happiness_countries_23_corr <span class="op">=</span> bottom_happiness_score_spotify_23_cleaned.corr()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bot_happiness_countries_23_corr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  danceability_avg  energy_avg  ...   freedom  generosity
danceability_avg          1.000000    0.376321  ... -0.416941    0.258785
energy_avg                0.376321    1.000000  ... -0.370953    0.288042
loudness_avg              0.014141    0.771896  ... -0.221699    0.338829
valence_avg               0.445008    0.512414  ... -0.058741   -0.233911
tempo_avg                 0.324271    0.604481  ... -0.680701    0.034410
happiness_score           0.409650    0.053272  ... -0.435316    0.332574
gdp_wellbeing            -0.605467   -0.391337  ...  0.402534   -0.270526
social_support            0.245714    0.223949  ... -0.492002    0.407425
life_exp                 -0.263315    0.234497  ...  0.226051    0.215015
freedom                  -0.416941   -0.370953  ...  1.000000    0.176183
generosity                0.258785    0.288042  ...  0.176183    1.000000

[11 rows x 11 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Create a heatmap using Seaborn</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(bot_happiness_countries_23_corr, </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>            vmin <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>            vmax <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>            center <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>            annot <span class="op">=</span><span class="va">True</span>,</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>            cmap <span class="op">=</span> <span class="st">'bwr_r'</span>,</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>            cbar_kws <span class="op">=</span> {<span class="st">'label'</span>: <span class="st">'Correlation'</span>},</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>            square <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>            linewidths <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>            annot_kws<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">6</span>})</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co">## Rotate x-axis labels</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation <span class="op">=</span> <span class="dv">45</span>, ha <span class="op">=</span> <span class="st">'right'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ 0.5,  1.5,  2.5,  3.5,  4.5,  5.5,  6.5,  7.5,  8.5,  9.5, 10.5]), [Text(0.5, 0, 'danceability_avg'), Text(1.5, 0, 'energy_avg'), Text(2.5, 0, 'loudness_avg'), Text(3.5, 0, 'valence_avg'), Text(4.5, 0, 'tempo_avg'), Text(5.5, 0, 'happiness_score'), Text(6.5, 0, 'gdp_wellbeing'), Text(7.5, 0, 'social_support'), Text(8.5, 0, 'life_exp'), Text(9.5, 0, 'freedom'), Text(10.5, 0, 'generosity')])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Rotate y-axis labels</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>plt.yticks(va <span class="op">=</span> <span class="st">'center'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ 0.5,  1.5,  2.5,  3.5,  4.5,  5.5,  6.5,  7.5,  8.5,  9.5, 10.5]), [Text(0, 0.5, 'danceability_avg'), Text(0, 1.5, 'energy_avg'), Text(0, 2.5, 'loudness_avg'), Text(0, 3.5, 'valence_avg'), Text(0, 4.5, 'tempo_avg'), Text(0, 5.5, 'happiness_score'), Text(0, 6.5, 'gdp_wellbeing'), Text(0, 7.5, 'social_support'), Text(0, 8.5, 'life_exp'), Text(0, 9.5, 'freedom'), Text(0, 10.5, 'generosity')])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Wrangling-Final-Project---Python-Pandas-ver-3-copy_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="comparing-2023-and-2025-spotify-dataset" class="level2">
<h2 class="anchored" data-anchor-id="comparing-2023-and-2025-spotify-dataset">Comparing 2023 and 2025 Spotify Dataset</h2>
<p>Since 2025 Happiness Report is not available yet, we will compare the average of music analytic components and note if there’s any changes.</p>
<section id="new-zealand" class="level3">
<h3 class="anchored" data-anchor-id="new-zealand">New Zealand</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>new_zealand_2023 <span class="op">=</span> (</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  spotify_global_2023_avg</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">"Country == 'New Zealand'"</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  .assign(year <span class="op">=</span> <span class="dv">2023</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  .reset_index()   <span class="co"># Need the Country as its own column</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Country  danceability_avg  energy_avg  ...  valence_avg   tempo_avg  year
0  New Zealand           0.65778    0.634505  ...     0.520736  122.809326  2023

[1 rows x 7 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Country', 'danceability_avg', 'energy_avg', 'loudness_avg',
       'valence_avg', 'tempo_avg', 'year'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Concat 2023 and 2025 New Zealand data into one table</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>new_zealand_spotify_combined <span class="op">=</span> pd.concat([new_zealand_2023, new_zealand_2025_avg])</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Melt the table along the Country and year</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>new_zealand_spotify_combined_melt <span class="op">=</span> new_zealand_spotify_combined.melt(</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  id_vars <span class="op">=</span> [<span class="st">'Country'</span>, <span class="st">'year'</span>],</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  value_vars<span class="op">=</span>[<span class="st">'danceability_avg'</span>, <span class="st">'energy_avg'</span>, <span class="st">'loudness_avg'</span>, <span class="st">'valence_avg'</span>, <span class="st">'tempo_avg'</span>],</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  var_name <span class="op">=</span> <span class="st">'Metrics'</span>,</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  value_name <span class="op">=</span> <span class="st">'value'</span>)  </span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>                                                                 </span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>                                                                 </span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_zealand_spotify_combined_melt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Country    year           Metrics       value
0  New Zealand  2023.0  danceability_avg    0.657780
1  New Zealand  2025.0  danceability_avg    0.601778
2  New Zealand  2023.0        energy_avg    0.634505
3  New Zealand  2025.0        energy_avg    0.609389
4  New Zealand  2023.0      loudness_avg   -6.839719
5  New Zealand  2025.0      loudness_avg   -7.293889
6  New Zealand  2023.0       valence_avg    0.520736
7  New Zealand  2025.0       valence_avg    0.533306
8  New Zealand  2023.0         tempo_avg  122.809326
9  New Zealand  2025.0         tempo_avg  120.254111</code></pre>
</div>
</div>
</section>
<section id="south-korea" class="level3">
<h3 class="anchored" data-anchor-id="south-korea">South Korea</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>south_korea_2023 <span class="op">=</span> (</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  spotify_global_2023_avg</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">"Country == 'South Korea'"</span>)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  .assign(year <span class="op">=</span> <span class="dv">2023</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  .reset_index()   <span class="co"># Need the Country as its own column</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Country  danceability_avg  energy_avg  ...  valence_avg   tempo_avg  year
0  South Korea           0.63944     0.63697  ...     0.489663  115.543886  2023

[1 rows x 7 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Country', 'danceability_avg', 'energy_avg', 'loudness_avg',
       'valence_avg', 'tempo_avg', 'year'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Concat 2023 and 2025 New Zealand data into one table</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>south_korea_spotify_combined <span class="op">=</span> pd.concat([south_korea_2023, south_korea_2025_avg])</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Melt the table along the Country and year</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>south_korea_spotify_combined_melt <span class="op">=</span> south_korea_spotify_combined.melt(</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  id_vars <span class="op">=</span> [<span class="st">'Country'</span>, <span class="st">'year'</span>],</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  value_vars<span class="op">=</span>[<span class="st">'danceability_avg'</span>, <span class="st">'energy_avg'</span>, <span class="st">'loudness_avg'</span>, <span class="st">'valence_avg'</span>, <span class="st">'tempo_avg'</span>],</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  var_name <span class="op">=</span> <span class="st">'Metrics'</span>,</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  value_name <span class="op">=</span> <span class="st">'value'</span>)  </span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>                                                                 </span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>                                                                 </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(south_korea_spotify_combined_melt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Country    year           Metrics       value
0  South Korea  2023.0  danceability_avg    0.639440
1  South Korea  2025.0  danceability_avg    0.639250
2  South Korea  2023.0        energy_avg    0.636970
3  South Korea  2025.0        energy_avg    0.687550
4  South Korea  2023.0      loudness_avg   -5.835685
5  South Korea  2025.0      loudness_avg   -6.180050
6  South Korea  2023.0       valence_avg    0.489663
7  South Korea  2025.0       valence_avg    0.557450
8  South Korea  2023.0         tempo_avg  115.543886
9  South Korea  2025.0         tempo_avg  135.761700</code></pre>
</div>
</div>
</section>
<section id="usa" class="level3">
<h3 class="anchored" data-anchor-id="usa">USA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>usa_2023 <span class="op">=</span> (</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  spotify_global_2023_avg</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">"Country == 'United States'"</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  .assign(year <span class="op">=</span> <span class="dv">2023</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  .reset_index()   <span class="co"># Need the Country as its own column</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Country  danceability_avg  energy_avg  ...  valence_avg   tempo_avg  year
0  United States           0.64152    0.626548  ...     0.450932  125.375067  2023

[1 rows x 7 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_2023.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Country', 'danceability_avg', 'energy_avg', 'loudness_avg',
       'valence_avg', 'tempo_avg', 'year'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Concat 2023 and 2025 New Zealand data into one table</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>usa_spotify_combined <span class="op">=</span> pd.concat([usa_2023, usa_2025_avg])</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Melt the table along the Country and year</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>usa_spotify_combined_melt <span class="op">=</span> usa_spotify_combined.melt(</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  id_vars <span class="op">=</span> [<span class="st">'Country'</span>, <span class="st">'year'</span>],</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  value_vars<span class="op">=</span>[<span class="st">'danceability_avg'</span>, <span class="st">'energy_avg'</span>, <span class="st">'loudness_avg'</span>, <span class="st">'valence_avg'</span>, <span class="st">'tempo_avg'</span>],</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  var_name <span class="op">=</span> <span class="st">'Metrics'</span>,</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  value_name <span class="op">=</span> <span class="st">'value'</span>)  </span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>                                                                 </span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>                                                                 </span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(usa_spotify_combined_melt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Country    year           Metrics       value
0  United States  2023.0  danceability_avg    0.641520
1  United States  2025.0  danceability_avg    0.556333
2  United States  2023.0        energy_avg    0.626548
3  United States  2025.0        energy_avg    0.591606
4  United States  2023.0      loudness_avg   -6.916220
5  United States  2025.0      loudness_avg   -7.557727
6  United States  2023.0       valence_avg    0.450932
7  United States  2025.0       valence_avg    0.460667
8  United States  2023.0         tempo_avg  125.375067
9  United States  2025.0         tempo_avg  124.565364</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
<script>
  window.backupDefine = window.define;
  window.define = undefined;
</script>
<script type="text/javascript" src="quarto-preview.js"></script>
<script>
  window.define = window.backupDefine;
  window.backupDefine = undefined;
</script>
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    window.QuartoPreview.init({
      origin: "",
      search: "",
      inputFile: "C:\Users\User\Documents\Project Files\Data Wrangling Final Project - Python Pandas ver 3 copy.qmd",
      isPresentation: false
    });
  })
</script>
